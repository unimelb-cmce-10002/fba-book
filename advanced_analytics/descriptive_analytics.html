<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Descriptive Analytics – Foundations of Business Analytics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../advanced_analytics/causal_analytics.html" rel="next">
<link href="../advanced_analytics/data_variation.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-601ca197ba2484b932d775b6c6a1237a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../solution.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../advanced_analytics/data_variation.html">Extracting Deeper Insights from Data</a></li><li class="breadcrumb-item"><a href="../advanced_analytics/descriptive_analytics.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Descriptive Analytics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Foundations of Business Analytics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundations/what_is_business_analytics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">What is Business Analytics?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundations/how_to_do_business_analytics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Core Skills of a “Business Scientist”</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundations/reproducible.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reproducible Workflows with R &amp; Posit Cloud</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting Our First Insights from Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../insights/data_visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualisation for Business Intelligence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../insights/data_manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Wrangling for Business Analytics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../insights/data_tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Shaping and Combining Data for Business Analytics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Finding and Storing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_management/data_storage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Storing and Using Existing Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_management/data_collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Collected Structured and Unstructured Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Extracting Deeper Insights from Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../advanced_analytics/data_variation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Variation in Cross-Sectional, Times-Series, and Panel Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../advanced_analytics/descriptive_analytics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Descriptive Analytics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../advanced_analytics/causal_analytics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Causal Analytics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../advanced_analytics/predictive_analytics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Forming and Evaluating Data-driven Predictions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/what_is_business_analytics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 1: Business Analytics Skills for Inventory Management</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/how_to_do_business_analytics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 2: Core Skills of a Business Scientist &amp; Introduction to Posit Cloud</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/data_visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 3: Data Visualisation for Business Intelligence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/data_wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 4: Data Wrangling for Business Analytics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/data_tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 5: Shaping and Joining Data for Business Analytics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/data_storage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 6: Storing &amp; Retrieving Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/data_collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 7: Obtaining Macroeconomic Data through FRED</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/data_variation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 8: Develop and Test Stock Trading Strategies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/descriptive_analytics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 9: Descriptive Analytics in HRM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/causal_analytics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 10: Causal Analytics to Improve User Sign Up Experiences</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/predictive_analytics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 11: Predictive Analytics for Workforce Planning</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-is-descriptive-analytics" id="toc-what-is-descriptive-analytics" class="nav-link active" data-scroll-target="#what-is-descriptive-analytics"><span class="header-section-number">10.1</span> What is Descriptive Analytics?</a></li>
  <li><a href="#the-business-challenge" id="toc-the-business-challenge" class="nav-link" data-scroll-target="#the-business-challenge"><span class="header-section-number">10.2</span> The Business Challenge</a>
  <ul class="collapse">
  <li><a href="#what-is-customer-segmentation" id="toc-what-is-customer-segmentation" class="nav-link" data-scroll-target="#what-is-customer-segmentation">What is Customer Segmentation?</a></li>
  <li><a href="#loading-the-r-packages-and-data" id="toc-loading-the-r-packages-and-data" class="nav-link" data-scroll-target="#loading-the-r-packages-and-data">Loading the R packages and Data</a></li>
  </ul></li>
  <li><a href="#rule-based-segmentation" id="toc-rule-based-segmentation" class="nav-link" data-scroll-target="#rule-based-segmentation"><span class="header-section-number">10.3</span> Rule-Based Segmentation</a>
  <ul class="collapse">
  <li><a href="#calculating-the-rfm-metrics" id="toc-calculating-the-rfm-metrics" class="nav-link" data-scroll-target="#calculating-the-rfm-metrics">Calculating the RFM metrics</a></li>
  <li><a href="#from-metrics-to-segments" id="toc-from-metrics-to-segments" class="nav-link" data-scroll-target="#from-metrics-to-segments">From Metrics to Segments</a></li>
  <li><a href="#naming-customer-segments" id="toc-naming-customer-segments" class="nav-link" data-scroll-target="#naming-customer-segments">Naming Customer Segments</a></li>
  </ul></li>
  <li><a href="#data-driven-segmentation" id="toc-data-driven-segmentation" class="nav-link" data-scroll-target="#data-driven-segmentation"><span class="header-section-number">10.4</span> Data-Driven Segmentation</a>
  <ul class="collapse">
  <li><a href="#going-beyond-rule-based-segmentation" id="toc-going-beyond-rule-based-segmentation" class="nav-link" data-scroll-target="#going-beyond-rule-based-segmentation">Going Beyond Rule-Based Segmentation</a></li>
  <li><a href="#preparing-data-for-clustering" id="toc-preparing-data-for-clustering" class="nav-link" data-scroll-target="#preparing-data-for-clustering">Preparing Data for Clustering</a></li>
  <li><a href="#clustering-with-k-means" id="toc-clustering-with-k-means" class="nav-link" data-scroll-target="#clustering-with-k-means">Clustering with K-means</a></li>
  <li><a href="#adding-cluster-assignments-to-the-data-profiling-consumers" id="toc-adding-cluster-assignments-to-the-data-profiling-consumers" class="nav-link" data-scroll-target="#adding-cluster-assignments-to-the-data-profiling-consumers">Adding Cluster Assignments to the Data &amp; Profiling Consumers</a></li>
  <li><a href="#how-many-clusters-should-we-use" id="toc-how-many-clusters-should-we-use" class="nav-link" data-scroll-target="#how-many-clusters-should-we-use">How Many Clusters Should We Use?</a></li>
  </ul></li>
  <li><a href="#wrap-up" id="toc-wrap-up" class="nav-link" data-scroll-target="#wrap-up"><span class="header-section-number">10.5</span> Wrap Up</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../advanced_analytics/data_variation.html">Extracting Deeper Insights from Data</a></li><li class="breadcrumb-item"><a href="../advanced_analytics/descriptive_analytics.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Descriptive Analytics</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Descriptive Analytics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Goals
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this chapter, students should be able to:</p>
<ul>
<li>Understand what descriptive analytics means in a business context and recognize its role as the foundation for more advanced approaches.</li>
<li>Explain how RFM provides a simple rule-based approach to customer segmentation.</li>
<li>Recognize the limitations of rule-based segmentation and why data-driven methods like K-means are useful.</li>
<li>Preprocess and scale data appropriately for clustering using recipes.</li>
<li>Apply K-means clustering to customer data, evaluate different choices of k, and visualize the results.</li>
<li>Interpret and compare K-means clusters with RFM segments to draw actionable business insights.</li>
</ul>
</div>
</div>
<section id="what-is-descriptive-analytics" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="what-is-descriptive-analytics"><span class="header-section-number">10.1</span> What is Descriptive Analytics?</h2>
<p>Descriptive analytics is the starting point of data analysis in business. It focuses on <strong>summarising past data to identify patterns and trends</strong>. Rather than predicting what will happen next or uncovering cause-and-effect relationships, descriptive analytics answers the question:</p>
<blockquote class="blockquote">
<p><strong>What happened?</strong></p>
</blockquote>
<p>In practice, descriptive analytics often takes the form of <strong>reports, dashboards, and summaries</strong> that help decision makers see what has occurred in their business. For example:</p>
<ul>
<li>A retailer might track sales by product category over the past month.</li>
<li>A streaming service might analyse which genres were most watched last quarter.</li>
<li>An airline might compare passenger loads across routes.</li>
</ul>
<p>These analyses do not tell us <em>why</em> the patterns occurred, nor do they predict <em>what will happen next</em>. Instead, they give us a <strong>clear picture of the past</strong>, which is essential for any further analysis.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Descriptive vs Predictive vs Causal Analytics
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Descriptive analytics</strong>: Summarises historical data to show what happened.</li>
<li><strong>Predictive analytics</strong>: Uses models to estimate what is likely to happen next.</li>
<li><strong>Causal analytics</strong>: Identifies cause-and-effect relationships to answer what would happen if we made a change.</li>
</ul>
</div>
</div>
</section>
<section id="the-business-challenge" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="the-business-challenge"><span class="header-section-number">10.2</span> The Business Challenge</h2>
<p>Descriptive analytics is especially important in <strong>customer analytics</strong>, where it helps us group customers by behaviour, spending, or engagement. But simply knowing what happened is not enough—businesses want to act on this information.</p>
<p>Suppose you are a marketing analyst working with data from the <strong>CDNOW Online Music Store</strong>, a retailer that sold CDs during the early years of e-commerce. The dataset you have contains detailed information on customers’ purchases between 1997 and 1998:</p>
<ul>
<li><strong>Who</strong> bought (customer ID).</li>
<li><strong>When</strong> they bought (purchase dates).</li>
<li><strong>How much</strong> they spent (transaction amounts).</li>
</ul>
<p>Your manager asks:</p>
<blockquote class="blockquote">
<p><strong>“Which customers should we target for our new loyalty campaign?”</strong></p>
</blockquote>
<p>This is a classic <strong>segmentation problem</strong>. Not all customers are equal: some shop frequently, some spend a lot, and others may be slipping away. Treating every customer the same wastes resources and misses opportunities.</p>
<p>To solve this problem, we will use descriptive analytics to <strong>summarise customer behaviour over time</strong> and identify meaningful groups. In this chapter, we will explore two approaches:</p>
<ol type="1">
<li><strong>RFM (Recency, Frequency, Monetary)</strong> — a simple, rule-based method that is easy to compute and interpret.</li>
<li><strong>K-means clustering</strong> — a data-driven method that uses algorithms to find patterns in behaviour that RFM might not pick up.</li>
</ol>
<p>By comparing these approaches on the CDNOW data, you will see how descriptive analytics provides the foundation for identifying customer groups that can guide real marketing decisions.</p>
<section id="what-is-customer-segmentation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="what-is-customer-segmentation">What is Customer Segmentation?</h3>
<p>Customer segmentation is the process of <strong>dividing a customer base into groups that share similar characteristics or behaviours</strong>. The goal is to treat customers differently depending on their value, needs, or potential, rather than applying a “one-size-fits-all” strategy.</p>
<p>In the case of the CDNOW Online Music Store, segmentation could mean:</p>
<ul>
<li>Identifying <strong>loyal repeat buyers</strong> who purchase many CDs over time.</li>
<li>Spotting <strong>big spenders</strong> who buy fewer times but place large orders.</li>
<li>Detecting <strong>at-risk customers</strong> who have not purchased recently.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why Segment Customers?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Businesses segment customers to: - Allocate marketing resources more effectively. - Target promotions to groups most likely to respond. - Protect valuable customers from churning. - Identify growth opportunities in overlooked groups.</p>
<p>Without segmentation, every customer is treated the same—leading to wasted resources and missed opportunities.</p>
</div>
</div>
<p>Segmentation is a form of <strong>descriptive analytics</strong>: it summarises the data into interpretable groups that can guide marketing strategy. Once customers are segmented, a business can ask targeted questions such as:</p>
<ul>
<li>Which group should receive a loyalty discount?</li>
<li>Which group is most at risk of churn?</li>
<li>Which group generates the most revenue?</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Segmentation vs.&nbsp;Personalisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Segmentation</strong> groups customers into categories (e.g., high-value vs.&nbsp;low-value).</li>
<li><strong>Personalisation</strong> tailors offers at the individual level.</li>
</ul>
<p>Segmentation is usually the first step toward more personalised strategies.</p>
</div>
</div>
</section>
<section id="loading-the-r-packages-and-data" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="loading-the-r-packages-and-data">Loading the R packages and Data</h3>
<p>To get started, we need to load the R packages that will help us work with the CDNOW dataset. We will use the <strong>tidyverse</strong> for data wrangling and reading in the CSV file, <strong>lubridate</strong> for handling dates.</p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the CDNOW purchases dataset</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>purchases <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/cdnow_purchases.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The purchases file contains transaction records for each customer. It includes four columns:</p>
<ul>
<li><code>id</code>: the customer identifier.</li>
<li><code>date</code>: the date of the purchase.</li>
<li><code>cds</code>: the number of CDs purchased in a transaction</li>
<li><code>amt</code>: the amount spent in that transaction.</li>
</ul>
<p>We can quickly check the structure of the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(purchases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 69,659
Columns: 4
$ users_id &lt;dbl&gt; 1, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5…
$ date     &lt;date&gt; 1997-01-01, 1997-01-12, 1997-01-12, 1997-01-02, 1997-03-30, …
$ cds      &lt;dbl&gt; 1, 1, 5, 2, 2, 2, 5, 4, 1, 2, 2, 1, 2, 2, 1, 3, 3, 3, 2, 2, 3…
$ amt      &lt;dbl&gt; 11.77, 12.00, 77.00, 20.76, 20.76, 19.54, 57.45, 20.96, 16.99…</code></pre>
</div>
</div>
<p>Notice that the <code>date</code> variable has been recognized as a date. This means we can use it “as-is” when we will need to apply date transformations going forward.</p>
</section>
</section>
<section id="rule-based-segmentation" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="rule-based-segmentation"><span class="header-section-number">10.3</span> Rule-Based Segmentation</h2>
<p>One simple way to group customers is through <strong>rule-based segmentation</strong>. In this approach, analysts define a set of <strong>rules or thresholds</strong> that assign customers to different groups.</p>
<p>For example:</p>
<ul>
<li>A retailer might classify <strong>“VIP customers”</strong> as anyone who spends more than $500 per month.</li>
<li>A subscription service might define <strong>“inactive customers”</strong> as those who have not logged in for 90 days.</li>
</ul>
<p>The strengths of rule-based segmentation is that it is <strong>easy to explain and apply</strong> and <strong>interpretable</strong> by humans. Managers can set rules based on business intuition and communicate them without technical detail. The limitation is that the rules are often <strong>arbitrary</strong>, and customers just above or below a threshold may be very similar in reality.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rule-Based vs.&nbsp;Data-Driven Segmentation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Rule-based</strong>: Groups are defined by fixed cutoffs chosen by analysts or managers.</li>
<li><strong>Data-driven</strong>: Groups are discovered by algorithms that search for natural patterns in the data.</li>
</ul>
</div>
</div>
<p>In customer analytics, one of the most widely used rule-based methods is <strong>RFM segmentation</strong>, which groups customers based on:</p>
<ul>
<li><strong>Recency</strong> of their last purchase.</li>
<li><strong>Frequency</strong> of their purchases.</li>
<li><strong>Monetary value</strong> of their purchases.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why RFM?
</div>
</div>
<div class="callout-body-container callout-body">
<p>RFM is one of the oldest and most widely used customer segmentation methods in marketing.</p>
<ul>
<li><strong>Recency, Frequency, Monetary</strong> measures are intuitive and easy to calculate.</li>
<li>They often capture a large share of the variation in customer value.</li>
<li>Many CRM and loyalty systems still rely on RFM as a starting point for segmentation.</li>
</ul>
<p>Because of this, RFM is an ideal first step for learning about segmentation before moving on to data-driven methods like K-means.</p>
</div>
</div>
<section id="calculating-the-rfm-metrics" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="calculating-the-rfm-metrics">Calculating the RFM metrics</h3>
<p>Our transaction dataset has one row per purchase: a customer ID, the date of purchase, and the amount spent. To compute RFM measures, we first need to <strong>aggregate</strong> this data to the customer level because we are describing features of a customer’s interactions with the company rather then each individual transaction.</p>
<p>For each customer, we will calculate:</p>
<ul>
<li><strong>Length of time since most recent purchase date (Recency)</strong></li>
<li><strong>Number of purchases (Frequency)</strong></li>
<li><strong>Total amount spent (Monetary)</strong></li>
</ul>
<p>The latter two of these metrics, Frequency and Monetary are much easier to calculate as they can be obtained from a <code>group_by()</code> and <code>summarise()</code> chain of commands. To find the length of time since most recent purchase date, we will need to do a bit more work. But, we will start by finding the date each customer most recently bought from the store:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>customer_aggregates <span class="ot">&lt;-</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  purchases <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(users_id) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">last_purch_date =</span> <span class="fu">max</span>(date),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">frequency    =</span> <span class="fu">n</span>(),      </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">monetary     =</span> <span class="fu">sum</span>(amt),   </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next we need to compute recency, i.e.&nbsp;time since last purchase. Since the data was collected in 1997-1998, computing a metric relative to now, i.e.&nbsp;the year 2025, seems a bit silly. Let’s suppose we were asked to do the analysis on the 1st of July 1998. We’ll store that value in R for later:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the analysis date</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note as_date is the tidyverse version of as.Date</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>analysis_date <span class="ot">&lt;-</span> <span class="fu">as_date</span>(<span class="st">"1998-07-01"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we will compute <code>recency</code>. We will compute the number of months between the analysis date and the last purchase. To do this, first we compute the length of time between two dates with <code>interval</code>, and then convert that length into months:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>customer_aggregates <span class="ot">&lt;-</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  customer_aggregates <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">recency =</span> <span class="fu">interval</span>(last_purch_date, analysis_date) <span class="sc">%/%</span> <span class="fu">months</span>(<span class="dv">1</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>last_purch_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These measures allow us to capture how fresh or established a customer’s relationship is with the business.</p>
</section>
<section id="from-metrics-to-segments" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="from-metrics-to-segments">From Metrics to Segments</h3>
<p>At this point, each customer has three measures, R, F and M:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(customer_aggregates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 23,570
Columns: 4
$ users_id  &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…
$ frequency &lt;int&gt; 1, 2, 6, 4, 11, 1, 3, 8, 3, 1, 4, 1, 1, 1, 1, 4, 1, 1, 2, 2,…
$ monetary  &lt;dbl&gt; 11.77, 89.00, 156.46, 100.50, 385.61, 20.99, 264.67, 197.66,…
$ recency   &lt;dbl&gt; 18, 17, 1, 6, 5, 18, 3, 3, 0, 17, 4, 18, 18, 18, 18, 9, 18, …</code></pre>
</div>
</div>
<p>These numbers are continuous, which makes them hard to compare directly across customers. For example:</p>
<ul>
<li>Is a customer with a recency of 4 months “recent” or “not recent”?</li>
<li>Is 12 purchases “frequent” or “average”?</li>
</ul>
<p>To make these comparisons easier, we group customers into <strong>segments</strong> by splitting each measure into categories. A common approach is to use <strong>5 segments (quintiles)</strong>:</p>
<ul>
<li><strong>1 = lowest group</strong> (e.g., least recent, least frequent, lowest spenders).</li>
<li><strong>5 = highest group</strong> (e.g., most recent, most frequent, biggest spenders).</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why 5 segments?
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Simple to interpret</strong>: a score from 1 to 5 for each metric.</li>
<li><strong>Balanced groups</strong>: quintiles divide customers so that each group has roughly 20% of the population.</li>
<li><strong>Flexible</strong>: fine-grained enough to capture variation, but not too detailed to overwhelm.</li>
</ul>
</div>
</div>
<p>We will use the function <code>ntile()</code> to split customers into quintiles. Let’s do that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>rfm_data <span class="ot">&lt;-</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a> customer_aggregates <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r_tile =</span> <span class="fu">ntile</span>(recency, <span class="dv">5</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">f_tile =</span> <span class="fu">ntile</span>(frequency, <span class="dv">5</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">m_tile =</span> <span class="fu">ntile</span>(monetary, <span class="dv">5</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s look at the output for <code>r_tile</code>. In particular let’s look at average recency per tile:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>rfm_data <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(r_tile) <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_r =</span> <span class="fu">mean</span>(recency))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  r_tile mean_r
   &lt;int&gt;  &lt;dbl&gt;
1      1   1.55
2      2   8.84
3      3  14.9 
4      4  16.0 
5      5  17.0 </code></pre>
</div>
</div>
<p>This is not what we wanted. Here the 5th quantile represents customers who on average interacted with the company approximately 17 months ago, the longest of all the quantiles. We wanted the 5th quantile to represent most recent, and the 1st quantile to be the longest. We’ll need to reverse that ranking. Reversing the ranking is unfortunately a bit more complex than we’d want.</p>
<p>How can we flip the numbers around?</p>
<ul>
<li>If a customer in tile 1 they should be in 5.</li>
<li>If a customer in tile 5 they should be in 1.</li>
<li>A customer in tile 3 should stay 3.</li>
</ul>
<p>Mathematically, we can do this by subtracting the tile number from the maximum, and then adding 1 back:</p>
<p><span class="math display">\[
\text{new tile} = (\text{max tile value})−(\text{old tile value})+1
\]</span></p>
<p>This simple formula inverts the direction of the recency scores while keeping them within the same 1–5 scale. Let’s implement it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>rfm_data <span class="ot">&lt;-</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  rfm_data <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">r_tile   =</span> <span class="fu">max</span>(r_tile) <span class="sc">-</span> r_tile <span class="sc">+</span> <span class="dv">1</span>,    <span class="co"># invert → 5 (recent) … 1 (stale)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the direction now: higher r_tile should mean more recent (lower recency)</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>rfm_data <span class="sc">|&gt;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(r_tile) <span class="sc">|&gt;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_r =</span> <span class="fu">mean</span>(recency), </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  r_tile mean_r
   &lt;dbl&gt;  &lt;dbl&gt;
1      1  17.0 
2      2  16.0 
3      3  14.9 
4      4   8.84
5      5   1.55</code></pre>
</div>
</div>
<p>Great – we now have scores for each customer along each of our three dimensions.</p>
<p>We can do the same check for Frequency and Monetary value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>rfm_data <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(f_tile) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_f =</span> <span class="fu">mean</span>(frequency), </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  f_tile mean_f
   &lt;int&gt;  &lt;dbl&gt;
1      1   1   
2      2   1   
3      3   1.47
4      4   2.75
5      5   8.56</code></pre>
</div>
</div>
<p>And</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>rfm_data <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(m_tile) <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_m =</span> <span class="fu">mean</span>(monetary), </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  m_tile mean_m
   &lt;int&gt;  &lt;dbl&gt;
1      1   12.4
2      2   24.0
3      3   44.4
4      4   90.1
5      5  359. </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember: We reverse the score for Recency only (smaller months since last purchase is better). Frequency and Monetary already have the right direction: higher is better.</p>
</div>
</div>
<p>These summaries allow us to profile the tiles:</p>
<ul>
<li>Higher R-scores mean more recent customers.</li>
<li>Higher F-scores mean more purchases.</li>
<li>Higher M-scores mean bigger spenders.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why Profile?
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s not enough to compute RFM tiles—we need to check and interpret them. Profiling tells us whether the scores are behaving as expected and gives us a first look at how different types of customers compare.</p>
</div>
</div>
</section>
<section id="naming-customer-segments" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="naming-customer-segments">Naming Customer Segments</h3>
<p>So far, our RFM tiles tell us whether a customer is more recent, more frequent, or a bigger spender. But managers don’t want to hear that “Customer 1032 is R = 5, F = 4, M = 3.” They want clear, interpretable <strong>segments</strong> that can guide action.</p>
<p>To do this, we can combine the three RFM scores into rule-based categories and assign <strong>meaningful names</strong>.</p>
<p>For example:</p>
<ul>
<li>A customer with <strong>R = 5, F = 5, M = 5</strong> is a <em>Champion</em> — very recent, very frequent, and high spending.</li>
<li>A customer with <strong>R = 1, F = 1, M = 1</strong> is <em>Lost</em> — they haven’t purchased in a long time, and even when they did, they didn’t buy much.</li>
</ul>
<p>Over time, analysts and marketers have developed a set of <strong>standard RFM-based segments</strong>. These categories provide an easy way to translate the numbers into <strong>meaningful customer types</strong>. The idea is to take combinations of Recency, Frequency, and Monetary scores and give them <strong>descriptive names</strong> that managers can act on.</p>
<p>The table below shows ten common segments, their criteria, and a short description:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="header">
<th>Segment</th>
<th>R (Recency)</th>
<th>F (Frequency)</th>
<th>M (Monetary)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Champions</strong></td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>Bought recently, buy often, and spend the most.</td>
</tr>
<tr class="even">
<td><strong>Potential Loyalist</strong></td>
<td>3–5</td>
<td>3–5</td>
<td>2–5</td>
<td>Recent customers, spent a good amount, bought more than once.</td>
</tr>
<tr class="odd">
<td><strong>Loyal Customers</strong></td>
<td>2–4</td>
<td>2–4</td>
<td>2–4</td>
<td>Spend well, responsive to promotions, consistent buyers.</td>
</tr>
<tr class="even">
<td><strong>Promising</strong></td>
<td>3–4</td>
<td>1–3</td>
<td>3–5</td>
<td>Recent shoppers but haven’t spent much.</td>
</tr>
<tr class="odd">
<td><strong>New Customers</strong></td>
<td>4–5</td>
<td>1–3</td>
<td>1–5</td>
<td>Bought recently but not often.</td>
</tr>
<tr class="even">
<td><strong>Can’t Lose Them</strong></td>
<td>1–2</td>
<td>3–4</td>
<td>4–5</td>
<td>Previously big spenders and frequent, but not purchased for a long time.</td>
</tr>
<tr class="odd">
<td><strong>At Risk</strong></td>
<td>1–2</td>
<td>2–5</td>
<td>4–5</td>
<td>Used to spend a lot and buy often, but long inactive now.</td>
</tr>
<tr class="even">
<td><strong>Need Attention</strong></td>
<td>1–3</td>
<td>3–5</td>
<td>3–5</td>
<td>Above average on most dimensions, could become loyal with the right push.</td>
</tr>
<tr class="odd">
<td><strong>About To Sleep</strong></td>
<td>2–3</td>
<td>1–3</td>
<td>1–4</td>
<td>Below average on recency, frequency, and monetary—at risk of being lost.</td>
</tr>
<tr class="even">
<td><strong>Lost</strong></td>
<td>1</td>
<td>1–5</td>
<td>1–5</td>
<td>Bought a long time ago, low engagement and value.</td>
</tr>
</tbody>
</table>
<p>This table gives us a behavioural profile of each segment. For example:</p>
<ul>
<li>Champions should have low recency (they bought recently), high frequency, and high monetary.</li>
<li>Lost customers should have very high recency (long inactive), low frequency, and low monetary.</li>
<li>At Risk should look like once-valuable customers who have gone quiet.</li>
</ul>
<p>By profiling, we check that our segmentation makes sense in practice before drawing business conclusions.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Names as Heuristics
</div>
</div>
<div class="callout-body-container callout-body">
<p>These categories are <strong>heuristics</strong> developed in practice. They are not set in stone — companies often <strong>adapt the cutoffs or labels</strong> to fit their business context. For example, an online retailer might define <em>Champions</em> differently from a subscription service.</p>
</div>
</div>
<p>Next, we will translate this table into R code so that each customer in our dataset is assigned to one of these segments.</p>
<p>We can build a full segmentation scheme with <code>case_when()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>rfm_segmented <span class="ot">&lt;-</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a> rfm_data <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">segment =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 1. Champions</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>   r_tile <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span> f_tile <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span> m_tile <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Champions"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 2. Potential Loyalist</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>   r_tile <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">&amp;</span> f_tile <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">&amp;</span> m_tile <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"Potential Loyalist"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 3. Loyal Customers</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>   r_tile <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">&amp;</span> f_tile <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">&amp;</span> m_tile <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> <span class="st">"Loyal Customers"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 4. Promising</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>   r_tile <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">&amp;</span> f_tile <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">&amp;</span> m_tile <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"Promising"</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 5. New Customers</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>   r_tile <span class="sc">%in%</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">&amp;</span> f_tile <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">&amp;</span> m_tile <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"New Customers"</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 6. Can't Lose Them</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>   r_tile <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">&amp;</span> f_tile <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">&amp;</span> m_tile <span class="sc">%in%</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"Can't Lose Them"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 7. At Risk</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>   r_tile <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">&amp;</span> f_tile <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">&amp;</span> m_tile <span class="sc">%in%</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"At Risk"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 8. Need Attention</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>   r_tile <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">&amp;</span> f_tile <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">&amp;</span> m_tile <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"Need Attention"</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 9. About To Sleep</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>   r_tile <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">&amp;</span> f_tile <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">&amp;</span> m_tile <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> <span class="st">"About To Sleep"</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 10. Lost</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>   r_tile <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> f_tile <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">&amp;</span> m_tile <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"Lost"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>   <span class="co"># fallback</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>   <span class="at">.default =</span> <span class="st">"Unclassified"</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that each customer has been assigned to a named segment, we can explore what these groups look like. A first check is to see <strong>how many customers fall into each category</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>rfm_segmented <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">count</span>(segment, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   segment                n
   &lt;chr&gt;              &lt;int&gt;
 1 Potential Loyalist  9678
 2 Lost                4453
 3 About To Sleep      3299
 4 Loyal Customers     3194
 5 Champions           2515
 6 Can't Lose Them      182
 7 Need Attention       112
 8 At Risk               84
 9 Promising             30
10 Unclassified          17
11 New Customers          6</code></pre>
</div>
</div>
<p>This shows us which groups dominate our customer base. In many datasets, we will see a large share of customers in “Lost” or “At Risk” segments, and only a small share in “Champions.”</p>
<p>Next, we can compute the average RFM values for each segment. This helps verify that the labels line up with the underlying behaviour:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>rfm_segmented <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(segment) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_recency  =</span> <span class="fu">mean</span>(recency),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_frequency =</span> <span class="fu">mean</span>(frequency),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_monetary =</span> <span class="fu">mean</span>(monetary),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_customers  =</span> <span class="fu">n</span>(),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_customers)) <span class="sc">|&gt;</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 17%">
<col style="width: 20%">
<col style="width: 18%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">segment</th>
<th style="text-align: right;">avg_recency</th>
<th style="text-align: right;">avg_frequency</th>
<th style="text-align: right;">avg_monetary</th>
<th style="text-align: right;">n_customers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Potential Loyalist</td>
<td style="text-align: right;">8.96</td>
<td style="text-align: right;">3.09</td>
<td style="text-align: right;">103.87</td>
<td style="text-align: right;">9678</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lost</td>
<td style="text-align: right;">16.95</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">30.00</td>
<td style="text-align: right;">4453</td>
</tr>
<tr class="odd">
<td style="text-align: left;">About To Sleep</td>
<td style="text-align: right;">15.57</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">15.24</td>
<td style="text-align: right;">3299</td>
</tr>
<tr class="even">
<td style="text-align: left;">Loyal Customers</td>
<td style="text-align: right;">15.80</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">40.60</td>
<td style="text-align: right;">3194</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Champions</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">10.88</td>
<td style="text-align: right;">447.90</td>
<td style="text-align: right;">2515</td>
</tr>
<tr class="even">
<td style="text-align: left;">Can’t Lose Them</td>
<td style="text-align: right;">16.63</td>
<td style="text-align: right;">2.26</td>
<td style="text-align: right;">159.09</td>
<td style="text-align: right;">182</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Need Attention</td>
<td style="text-align: right;">16.96</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">44.50</td>
<td style="text-align: right;">112</td>
</tr>
<tr class="even">
<td style="text-align: left;">At Risk</td>
<td style="text-align: right;">16.05</td>
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">180.98</td>
<td style="text-align: right;">84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Promising</td>
<td style="text-align: right;">15.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">121.35</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unclassified</td>
<td style="text-align: right;">14.35</td>
<td style="text-align: right;">1.47</td>
<td style="text-align: right;">129.82</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">New Customers</td>
<td style="text-align: right;">7.83</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">13.17</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="exercise">
<div class="exercise-time">
<p>5 min</p>
</div>
<p>Let’s bring these segment results back to the original business questions we had:</p>
<ol type="1">
<li>Which segment is most valuable?</li>
<li>If you were running a loyalty campaign, which groups would you target first?</li>
<li>Which groups might not be worth investing in?</li>
</ol>
</div>
<div class="solution-header">
<p>Solution</p>
</div>
<div class="solution-content">
<p><strong>1. Which segment is most valuable?</strong> - Typically, the <strong>Champions</strong> segment is the most valuable. - They buy recently, buy often, and spend the most. - Even if the group is relatively small, they drive a disproportionate share of revenue.</p>
<p><strong>2. If you were running a loyalty campaign, which groups would you target first?</strong> - Start with <strong>Champions</strong> to keep them engaged and feeling rewarded. - Next, look at <strong>Potential Loyalists</strong> and <strong>Loyal Customers</strong> — they already show good behaviour and can be nurtured into long-term, high-value relationships. - <strong>At Risk</strong> customers are also candidates: a well-designed campaign could bring them back before they are lost completely.</p>
<p><strong>3. Which groups might not be worth investing in?</strong> - <strong>Lost</strong> customers: if someone hasn’t purchased in a very long time, the cost of reactivation may outweigh the benefits. - <strong>Promising</strong> or <strong>About to Sleep</strong> customers: these are lower-value segments where heavy marketing investment may not deliver strong returns. - For these groups, a light-touch or automated approach (e.g., generic email offers) is usually more efficient.</p>
</div>
</section>
</section>
<section id="data-driven-segmentation" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="data-driven-segmentation"><span class="header-section-number">10.4</span> Data-Driven Segmentation</h2>
<section id="going-beyond-rule-based-segmentation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="going-beyond-rule-based-segmentation">Going Beyond Rule-Based Segmentation</h3>
<p>Up to this point, we have grouped customers using <strong>RFM segmentation</strong> with rules defined by us as modellers. This approach gave us a clear structure: we defined Recency, Frequency, and Monetary measures, divided customers into tiles, and then named the resulting segments. It is simple, intuitive, and widely used in practice.</p>
<p>But there are some important limitations:</p>
<ul>
<li>The cutoffs we used for tiles are somewhat arbitrary.</li>
<li>Customers who are very similar might end up in different groups because they fall on opposite sides of a threshold.</li>
<li>The rule-based segments we created reflect business intuition, but they may not capture the <strong>natural patterns in the data</strong>.</li>
</ul>
<p>This motivates our next step: moving to a <strong>data-driven segmentation method</strong>. Instead of us setting the rules, we will let an algorithm search for groups of customers that are <strong>similar to one another and different from others</strong>. The method we will use is called <strong>K-means clustering</strong>.</p>
<p>To do this, we will go through three main steps:</p>
<ol type="1">
<li><p><strong>Put variables on the same scale</strong> K-means compares customers using distance. If we don’t rescale, variables with large numbers (like total spending) will dominate those with smaller numbers (like recency in months).</p></li>
<li><p><strong>Run the clustering algorithm</strong> We choose a number of clusters (<em>k</em>), and K-means assigns each customer to the group with the closest “center.” This step groups customers by similarity across our Recency, Frequency, and Monetary measures.</p></li>
<li><p><strong>Decide how many clusters make sense</strong> Choosing <em>k</em> is part of the analysis. We’ll test different values and use diagnostics to see which number of clusters best describes the data.</p></li>
</ol>
<p>Our purpose here is not to replace RFM but to compare approaches:</p>
<ul>
<li>RFM shows how analysts can create interpretable, rule-based groups.</li>
<li>K-means shows how algorithms can discover structure we might miss.</li>
</ul>
<p>Next, we will begin by <strong>preparing the data</strong> so that K-means treats each RFM measure fairly.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is an Algorithm?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In everyday life, people often use “algorithm” to mean “some mysterious computer program.” In fact, the idea is much simpler.</p>
<p>An <strong>algorithm</strong> is just a <strong>step-by-step procedure</strong> for solving a problem. - A cooking recipe is an algorithm for preparing a dish. - Long division is an algorithm for dividing numbers. - K-means is an algorithm for grouping customers into clusters.</p>
<p>Algorithms can be done by hand (slowly!) or by computer (very quickly). The power of data analytics comes from running these algorithms at scale.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RFM as a Human Algorithm
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When we built RFM segments, we were already following an <strong>algorithm</strong> — a fixed set of steps to reach a result:</p>
<ol type="1">
<li>Calculate Recency, Frequency, and Monetary values for each customer.</li>
<li>Split each measure into tiles (1–5).</li>
<li>Apply rules to assign customers to named segments.</li>
</ol>
<p>This is a <strong>rule-based algorithm</strong>: the steps were designed by us as analysts.</p>
<p>K-means is different in that it is a <strong>data-driven algorithm</strong>: instead of us writing the rules, the computer searches for patterns in the data to define the groups.</p>
</div>
</div>
</div>
</section>
<section id="preparing-data-for-clustering" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="preparing-data-for-clustering">Preparing Data for Clustering</h3>
<p>Before we jump into running K-means, we need to stop and think about <strong>the data we are giving to the algorithm</strong>.</p>
<p>K-means works by measuring the <strong>distance</strong> between customers in terms of their features (here: Recency, Frequency, Monetary). This means that the <strong>scale of each variable matters</strong>:</p>
<ul>
<li>Recency is measured in <strong>months</strong>.</li>
<li>Frequency is measured as a <strong>count of purchases</strong>.</li>
<li>Monetary is measured in <strong>dollars spent</strong>.</li>
</ul>
<p>If we feed these raw values into K-means, the algorithm will be dominated by whichever variable has the largest scale. For example, if spending runs into the hundreds while recency is only a few months, the clusters will mostly reflect differences in spending.</p>
<p>Let’s check the ranges of our three measures:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>rfm_data <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_recency  =</span> <span class="fu">min</span>(recency),  </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_recency  =</span> <span class="fu">max</span>(recency),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_frequency =</span> <span class="fu">min</span>(frequency), </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_frequency =</span> <span class="fu">max</span>(frequency),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_monetary =</span> <span class="fu">min</span>(monetary), </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_monetary =</span> <span class="fu">max</span>(monetary)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a> ) <span class="sc">|&gt;</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">pivot_longer</span>(</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">everything</span>(),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"stat"</span>, <span class="st">"variable"</span>),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_sep =</span> <span class="st">"_"</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a> ) <span class="sc">|&gt;</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a> <span class="fu">pivot_wider</span>(</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_from =</span> stat,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_from =</span> value</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  variable    min    max
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
1 recency       0    18 
2 frequency     1   217 
3 monetary      0 13991.</code></pre>
</div>
</div>
<p>This shows us the smallest and largest values for each variable.</p>
<ul>
<li>Recency ranges from 0 to 18 months.</li>
<li>Frequency ranges from 1 to 217 purchases.</li>
<li>Monetary ranges from a zero dollars to several thousand dollars.</li>
</ul>
<p>Clearly, these are on very different scales. If we run K-means on these raw numbers, the algorithm will mostly detect differences in monetary value, because that variable spans thousands, while barely noticing differences in recency or frequency.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Potential Pitfall: Scale matters
</div>
</div>
<div class="callout-body-container callout-body">
<p>Clustering is a distance-based method. Variables with larger numeric ranges will dominate the distance calculations, making smaller-range variables nearly irrelevant.</p>
</div>
</div>
<p>To avoid the issues due to different scales, we standardise our variables so that each has:</p>
<ul>
<li>Mean = 0</li>
<li>Standard deviation = 1</li>
</ul>
<p>This transformation makes Recency, Frequency, and Monetary comparable in how much they can influence the clustering.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Scaling and Z-scores
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When we <strong>standardise</strong> a variable, we are turning it into a <strong>z-score</strong>. This means we subtract the mean and divide by the standard deviation:</p>
<p><span class="math display">\[
z = \frac{x - \text{mean}(x)}{\text{sd}(x)}
\]</span></p>
<ul>
<li>A value of 0 means the observation is right at the average.</li>
<li>Positive values mean it is above average.</li>
<li>Negative values mean it is below average.</li>
</ul>
<p>Why does this matter for clustering? K-means groups customers by calculating distances between them. If one variable has a very large numeric range (say, spending in the thousands), and another has a smaller range (say, recency in months), the large-range variable will dominate the distance calculation.</p>
<p>By converting all variables to z-scores, we: - Remove differences in scale (months, counts, dollars). - Put them on a <strong>common yardstick</strong> where 1 unit always means “1 standard deviation from the mean.” - Ensure that <strong>each measure contributes equally to the distance calculation</strong>, so clustering reflects <em>all three dimensions</em> of customer behaviour, not just the one with the largest numbers.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
n-Tiles vs.&nbsp;Scaling
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Earlier, when we built RFM segments, we used <strong>n-tiles</strong> (quintiles) to rank customers from 1 to 5 on each measure. This was another way of handling differences in scale:</p>
<ul>
<li>Instead of comparing raw values (e.g., dollars vs.&nbsp;months), we compared <strong>relative positions</strong> within the distribution.</li>
<li>A customer in tile 5 for Recency is in the <strong>top 20% most recent</strong> purchasers, regardless of whether that means 2 months or 10 days.</li>
</ul>
<p>Scaling with z-scores serves a similar purpose: - Both methods transform raw variables into a form where they can be compared more directly. - The key difference is that <strong>tiles rank customers</strong> relative to each other, while <strong>z-scores measure distance</strong> from the mean in standard deviation units.</p>
<p>This is why scaling is essential for clustering: it keeps the <em>distances</em> meaningful across all variables, rather than just their ranks.</p>
</div>
</div>
</div>
<section id="scaling-variables-by-hand" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="scaling-variables-by-hand">Scaling Variables by Hand</h4>
<p>Let’s start small by scaling just one variable: <strong>monetary value</strong>. Recall how to calculate the mean and standard deviation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>rfm_data <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_m =</span> <span class="fu">mean</span>(monetary),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd_m  =</span> <span class="fu">sd</span>(monetary)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  mean_m  sd_m
   &lt;dbl&gt; &lt;dbl&gt;
1   106.  241.</code></pre>
</div>
</div>
<p>We can use these summary statistics to compute a scaled measure for <code>monetary</code> for all customers in the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>rfm_data <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">monetary_scaled =</span> (monetary <span class="sc">-</span> <span class="fu">mean</span>(monetary)) <span class="sc">/</span> <span class="fu">sd</span>(monetary)) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">select</span>(monetary, monetary_scaled) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   monetary monetary_scaled
      &lt;dbl&gt;           &lt;dbl&gt;
 1     11.8         -0.391 
 2     89           -0.0709
 3    156.           0.209 
 4    101.          -0.0232
 5    386.           1.16  
 6     21.0         -0.353 
 7    265.           0.658 
 8    198.           0.380 
 9     95.8         -0.0425
10     39.3         -0.277 </code></pre>
</div>
</div>
</section>
<section id="scaling-variables-with-recipes" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="scaling-variables-with-recipes">Scaling Variables with <code>recipes</code></h4>
<p>Doing this for one variable makes the idea of scaling clear, but manually calculating across what could be many variables is tedious. And we know that when we are manually writing tedious code with the tidyverse, we are probably missing a more efficient and reproducible approach.</p>
<p>This is where the <code>recipes</code> package comes in. Recipes let us define a set of preprocessing steps — like scaling — that can be applied consistently across multiple variables. The big advantage is that the recipe keeps track of <em>how</em> the data was transformed, making the process transparent and easy to reproduce.</p>
<p>We start by using the <code>recipe</code> function to write a set of steps we want to perform:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(recipes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'recipes'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stringr':

    fixed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    step</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>rfm_rec <span class="ot">&lt;-</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(<span class="sc">~</span> recency <span class="sc">+</span> frequency <span class="sc">+</span> monetary, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> rfm_data) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we created a simple preprocessing plan, i.e.&nbsp;a recipe, that tells R which variables to prepare and how. In <code>recipe(~ recency + frequency + monetary, data = rfm)</code>, the tilde, <code>~</code>, is the formula separator: the left side is for something you want to predict (an outcome) and the right side lists the input variables. When clustering, there’s no outcome variable in the data that we are trying to predict — we’re just grouping customers—so we leave the left side empty and list our inputs on the right: recency, frequency, and monetary. We then pipe into the next step <code>step_normalize(all_numeric_predictors())</code> which standardises each of those numeric variables (turn them into z-scores). If we then look at the object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>rfm_rec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>predictor: 3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Operations </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Centering and scaling for: all_numeric_predictors()</code></pre>
</div>
</div>
<p>When we printed <code>rfm_rec</code>, you may have noticed something curious: the data itself wasn’t transformed yet. Instead, R showed us a <strong>blueprint</strong> of what will happen — which variables are included (<code>recency</code>, <code>frequency</code>, <code>monetary</code>), the role they play (all as predictors, since there’s no outcome in clustering), and the step that will be applied (<code>step_normalize()</code>). This design is intentional: a recipe describes the instructions, but it does not execute them right away.</p>
<p>To actually make the transformations, we need to <strong>prep</strong> the recipe. Think of this as training the recipe on our data, or, more informally, as preparing the ingredients before cooking. For the scaling we want to do, <code>prep()</code> calculates the mean and standard deviation of each variable so that it knows exactly how to convert them into z-scores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>rfm_prepped <span class="ot">&lt;-</span> <span class="fu">prep</span>(rfm_rec)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>rfm_prepped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>predictor: 3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Training information </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Training data contained 23570 data points and no incomplete rows.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Operations </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Centering and scaling for: recency, frequency, monetary | Trained</code></pre>
</div>
</div>
<p>The output is still a recipe object, but now it has all the information required to perform the transformation. the output looks similar to the earlier recipe, but with an important difference: it now shows that the <code>step_normalize()</code> step has been trained. Behind the scenes, R has stored the mean and standard deviation of each variable (recency, frequency, and monetary) based on the data we provided. The result is still a recipe object, but now it contains all the information needed to perform the transformation. Intuitively, this is the same as weighing out all the ingredients before you start cooking — everything is ready, but the meal hasn’t been served yet.</p>
<p>Finally, we use <strong>bake</strong> to apply the recipe to the data. If <code>prep()</code> was about preparing the ingredients, then <code>bake()</code> is the step where we actually cook the dish and put it on the table. <code>bake()</code> takes the prepared recipe and returns a new data frame with the standardized variables ready to use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>rfm_scaled <span class="ot">&lt;-</span> <span class="fu">bake</span>(rfm_prepped, <span class="at">new_data =</span> <span class="cn">NULL</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rfm_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  recency frequency monetary
    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1   1.07     -0.413  -0.391 
2   0.901    -0.202  -0.0709
3  -1.79      0.643   0.209 
4  -0.947     0.221  -0.0232
5  -1.12      1.70    1.16  
6   1.07     -0.413  -0.353 </code></pre>
</div>
</div>
<p>By using <code>new_data = NULL</code>, we tell R to apply the recipe to the same data that was used when we prepped it. The result is a data frame where recency, frequency, and monetary have all been transformed into z-scores — each with mean zero and standard deviation one. Let’s check that our scaling worked as intended. If the recipe did its job, each of our variables — <code>recency</code>, <code>frequency</code>, and <code>monetary</code> — should now have a mean of zero and a standard deviation of one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>rfm_scaled <span class="sc">|&gt;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">everything</span>(),</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">sd =</span> sd)) <span class="sc">|&gt;</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"variable"</span>, <span class="st">".value"</span>),</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">recency</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">frequency</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">monetary</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Same Recipe, New Data?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If you later want to apply the same recipe to a new dataset (e.g., fresh customers with the same variables), you can supply use the same code as above with <code>new_data = rfm_data</code> instead of <code>NULL</code>. This makes recipes especially powerful for production settings, where the same preprocessing steps need to be applied consistently over time.</p>
</div>
</div>
</div>
</section>
</section>
<section id="clustering-with-k-means" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="clustering-with-k-means">Clustering with K-means</h3>
<p>Now that our variables are standardized, we are ready to group customers using <strong>K-means clustering</strong>. This is one of the most widely used clustering methods in business analytics because it is simple, fast, and effective.</p>
<p>The basic idea is to divide customers into groups where those in the same group are more similar to each other (in terms of recency, frequency, and monetary value) than to customers in other groups. Instead of setting rules ourselves — as we did with RFM quintiles — we let the algorithm discover the natural groupings in the data.</p>
<p>At a high level, the process works like this:</p>
<ul>
<li><p><strong>Step 1: Decide on (k).</strong> We choose how many clusters we want the algorithm to find. Think of this as telling it, “please uncover (k) different types of customers.”</p></li>
<li><p><strong>Step 2: Assign customers to clusters.</strong> Each customer is assigned to the cluster with the nearest <strong>center point</strong> (called a <em>centroid</em>). A centroid is simply the <strong>average customer</strong> in the cluster. It is calculated by taking the average recency, the average frequency, and the average monetary value of all customers currently in the group. For example, if three customers had frequencies of 2, 4, and 6 purchases, the cluster’s frequency centroid would be ((2+4+6)/3 = 4). In this way, the centroid represents the “typical customer” in that group.</p></li>
<li><p><strong>Step 3: Update the centroids.</strong> Once customers are assigned, the centroid of each cluster is recalculated. This makes the center points shift toward where most of the customers really are.</p></li>
<li><p><strong>Step 4: Reassign customers.</strong> Customers are then reassigned to whichever centroid they are now closest to.</p></li>
</ul>
<p>This cycle of recalculating averages and reassigning customers repeats until the groups stop changing. At that point, the clustering is considered stable.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Clustering as a Networking Event for Your Data
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can think of this process like a networking event. At first, people cluster around randomly chosen “representatives.” As the crowd shifts, the representatives change to reflect the average person in their group. People keep moving until they find themselves in the group that feels like the best fit — and then the groups stop changing.</p>
</div>
</div>
<p>Let’s see how this works in practice by running K-means on our CDNOW dataset with (k = 3) clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>kmeans_3 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(rfm_scaled, <span class="at">centers =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why set a seed?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>K-means starts by placing centroids in random positions before it begins the averaging-and-reassigning process. Because of this, you can get slightly different results each time you run the algorithm.</p>
<p>By setting a random <strong>seed</strong> (e.g., <code>set.seed(123)</code>), we make the results reproducible — so that if you (or your manager, or your professor) rerun the code, you will get the same clusters. This is especially important in reporting, where consistency matters.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Raw K-means Output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If you print the <code>kmeans()</code> result directly, the output can look a little overwhelming:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>kmeans_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 3 clusters of sizes 150, 16287, 7133

Cluster means:
     recency  frequency   monetary
1 -1.7662623  7.0567254  7.8076613
2  0.6198065 -0.3276554 -0.2598818
3 -1.3780806  0.5997497  0.4292088

Clustering vector:
    [1] 2 2 3 3 3 2 3 3 3 2 3 2 2 2 2 3 2 2 2 2 2 2 2 3 3 2 2 2 3 2 3 3 1 2 2 2
   [37] 3 2 3 3 2 2 3 2 2 3 3 3 2 2 3 3 3 2 2 3 2 2 2 2 2 3 3 3 3 2 2 2 2 2 2 2
   [73] 2 2 2 2 2 3 2 2 3 3 3 2 2 2 3 2 3 2 2 2 2 2 1 1 3 2 3 3 2 3 3 2 2 3 2 2
  [109] 2 2 3 2 3 3 2 2 3 2 2 3 2 2 2 3 3 3 2 2 2 3 2 3 3 3 2 3 2 2 2 2 3 3 2 2
  [145] 3 2 3 3 2 2 2 3 2 3 2 2 2 2 2 2 3 2 2 3 3 3 3 2 2 3 2 2 3 2 2 2 3 2 3 2
  [181] 2 3 2 3 3 2 2 2 2 2 2 3 2 2 3 2 2 2 2 2 3 2 2 2 3 2 3 3 2 3 2 2 2 3 2 2
  [217] 3 2 2 2 2 3 2 2 2 3 3 3 3 2 2 2 2 2 2 2 2 3 2 2 3 2 2 1 3 3 3 2 2 2 2 3
  [253] 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2 2 2 2
  [289] 2 2 2 3 3 3 3 2 2 2 3 3 3 2 2 2 3 2 2 2 2 2 2 3 1 2 2 2 3 3 2 2 2 2 3 2
  [325] 2 2 2 3 3 2 2 2 2 2 2 2 3 2 3 2 2 2 3 3 3 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3
  [361] 3 2 2 2 3 2 2 3 2 3 3 2 3 3 2 3 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 3
  [397] 2 1 2 3 2 2 2 3 2 3 2 2 2 3 1 3 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 3 3 3 2
  [433] 3 2 2 2 2 2 2 2 3 2 2 2 3 3 2 2 2 2 2 2 2 3 2 3 2 3 2 2 3 2 2 3 2 2 2 2
  [469] 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 3 3 2 2 3 2 3 2 3 2 2 2 2 2 2 1 2 2 2 2 3
  [505] 3 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  [541] 2 2 2 2 3 3 3 3 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 3 2 3 3 3 3 3 2 3 3 2 2 2
  [577] 2 2 2 2 2 3 3 2 3 1 3 2 3 3 3 2 3 2 3 2 2 3 2 2 2 3 2 2 2 3 2 3 3 3 2 2
  [613] 2 3 2 3 2 2 1 2 2 2 2 3 2 3 2 2 3 2 3 2 3 2 3 2 2 3 2 2 2 2 3 2 3 3 2 2
  [649] 3 2 2 2 3 2 2 3 2 2 3 2 2 3 3 2 2 2 2 2 2 3 3 2 2 3 2 2 2 2 2 2 2 2 2 2
  [685] 2 2 3 2 2 2 3 2 2 2 2 2 2 3 3 2 2 3 2 3 3 2 2 2 2 1 3 3 2 2 2 2 3 3 2 2
  [721] 2 3 2 2 2 2 2 2 3 3 3 3 2 2 3 2 3 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 3 2 2 2
  [757] 2 1 3 3 2 2 2 3 3 3 3 2 2 2 2 3 3 2 2 3 2 3 2 3 2 2 3 3 2 2 2 2 3 3 2 2
  [793] 2 2 2 2 3 2 3 3 2 2 2 3 3 3 2 3 2 2 3 2 2 2 2 2 2 2 2 3 3 2 2 3 3 2 3 2
  [829] 2 3 2 2 2 2 2 3 3 2 2 3 2 2 3 2 3 3 2 3 3 3 2 2 2 2 2 3 2 2 2 3 3 2 2 2
  [865] 2 2 2 2 2 3 3 2 3 3 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 3 3 2 3 2 3 2 2 2 2
  [901] 3 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 2 3 2 3 2 2 3 2 2 3 3 2 2 2 3 3 2 2 2 2
  [937] 2 3 2 2 3 3 2 2 3 3 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 3 2 2 2 2
  [973] 2 2 2 2 2 2 3 3 3 2 2 2 3 2 2 3 2 2 3 3 3 3 2 2 3 3 3 2 2 3 2 3 2 2 2 2
 [1009] 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 3 2 3 2 3 2 2 2
 [1045] 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 3 2 2 2 3 2 1 3 2 2
 [1081] 2 3 3 3 3 3 3 2 3 2 2 3 2 3 2 2 2 2 3 2 2 2 2 3 2 2 2 3 2 2 3 2 2 3 2 2
 [1117] 2 2 2 3 3 2 2 2 2 2 2 2 2 2 2 3 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2
 [1153] 3 2 3 2 3 2 2 2 3 2 2 2 2 2 3 2 2 3 3 2 2 2 2 3 2 2 2 3 2 2 3 2 3 2 2 2
 [1189] 2 3 2 3 2 2 3 3 2 2 2 2 3 2 2 2 3 2 2 3 2 2 2 3 3 2 2 2 2 2 2 2 3 2 2 2
 [1225] 2 3 2 3 3 2 2 3 2 2 2 3 3 2 2 2 3 2 2 3 2 2 3 3 2 3 3 2 2 3 2 2 3 3 2 3
 [1261] 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 3 3 2 3 3 3 2 3
 [1297] 2 2 2 2 3 2 2 2 2 2 2 2 3 3 2 2 3 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2
 [1333] 3 2 2 2 2 2 2 2 3 3 3 3 2 3 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 3 2 2 2 2 2 2
 [1369] 2 3 2 2 2 2 3 3 2 2 2 2 2 3 2 2 3 3 2 2 2 2 2 2 3 2 2 3 2 3 2 3 2 2 2 2
 [1405] 2 3 2 2 3 3 3 3 3 3 2 3 3 2 2 2 3 2 3 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 3 2
 [1441] 2 2 2 3 3 2 3 3 2 3 2 2 2 2 2 2 2 3 2 3 2 2 2 3 2 2 2 3 2 3 3 2 3 3 2 2
 [1477] 2 2 2 2 2 2 2 2 2 2 2 3 3 3 2 2 2 3 2 3 2 2 2 3 3 2 2 2 2 3 2 2 3 3 2 2
 [1513] 2 3 2 3 2 2 2 2 2 2 3 2 3 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2
 [1549] 2 3 3 2 2 2 2 3 2 2 2 2 3 2 3 3 2 3 2 2 2 2 2 3 3 2 2 2 3 2 2 3 3 3 3 3
 [1585] 3 3 2 2 3 3 2 2 3 3 2 3 2 3 2 3 3 3 3 2 2 3 3 2 3 3 2 2 3 2 2 3 2 2 2 2
 [1621] 2 2 3 2 2 3 2 2 2 2 2 3 3 2 3 2 3 3 2 2 2 3 2 3 3 3 3 2 3 2 2 2 2 3 2 3
 [1657] 2 3 2 2 3 2 2 2 2 2 2 3 3 2 2 3 3 2 3 2 2 2 2 2 2 2 2 3 2 3 3 2 3 3 2 2
 [1693] 2 2 3 3 3 2 3 3 2 2 3 2 3 3 3 2 2 2 3 2 3 2 2 3 2 2 3 3 2 1 2 3 3 3 2 3
 [1729] 2 2 2 3 2 2 2 3 2 3 2 2 3 2 2 2 3 2 2 2 2 2 2 3 2 2 3 2 3 2 3 1 2 2 2 3
 [1765] 3 2 2 3 3 2 2 3 3 2 2 2 2 2 2 3 2 2 2 2 3 2 2 2 2 3 3 2 3 1 2 3 2 2 3 2
 [1801] 2 3 2 2 3 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3 3 2 3
 [1837] 2 2 2 2 2 3 2 2 3 3 2 1 2 3 3 2 2 3 2 2 2 2 2 2 2 2 3 3 2 2 3 1 3 2 3 2
 [1873] 2 3 2 2 3 2 2 2 3 3 3 2 2 2 2 2 2 1 2 2 3 2 2 2 3 2 2 2 2 2 3 2 2 2 3 2
 [1909] 3 2 2 2 2 2 2 3 2 3 3 3 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2
 [1945] 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 1 2 2 2 2 3 2 2 3 2 2 2 3 2 2 1
 [1981] 3 2 3 2 2 2 2 2 2 2 3 2 3 2 2 3 3 2 3 2 3 2 3 2 2 2 2 2 2 2 2 2 3 2 2 3
 [2017] 2 2 2 2 3 3 2 2 2 2 3 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2 2 3 2 3 2 3 2 2 2 2
 [2053] 3 2 2 3 2 3 2 2 3 2 2 3 2 1 3 2 3 2 2 3 2 2 2 2 2 3 2 2 3 2 2 3 2 2 2 2
 [2089] 2 3 2 3 2 2 2 2 2 2 3 2 3 3 2 2 2 3 3 3 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 3
 [2125] 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 3 3 3 2 2 2 2 3 2 2 2 2 3 3 2
 [2161] 2 2 3 3 2 3 2 2 2 2 3 2 3 2 2 2 3 2 2 2 2 2 3 2 2 2 2 3 3 3 2 2 2 3 2 2
 [2197] 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 3 2 2 3 2 3 2 3 2 2 3 3 2 2 2 2 3 3 2 2 2
 [2233] 2 2 2 2 2 3 2 3 2 3 2 2 2 2 3 2 2 3 2 2 3 2 2 3 2 2 2 3 2 2 2 3 2 3 2 2
 [2269] 2 2 2 2 2 2 3 2 2 2 2 3 2 3 2 2 2 3 2 3 2 3 2 2 2 2 3 3 2 2 3 2 2 2 2 3
 [2305] 3 2 3 3 3 2 3 2 2 2 3 3 3 2 2 2 2 3 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 2 2
 [2341] 2 3 2 2 2 2 2 2 3 2 3 2 2 2 3 3 3 3 3 3 2 2 2 3 2 3 2 3 2 3 2 2 2 3 2 2
 [2377] 3 3 2 2 2 2 2 2 2 2 2 1 3 3 2 2 3 3 2 2 2 2 2 3 2 2 2 2 3 2 2 2 2 2 2 3
 [2413] 2 2 2 2 2 2 3 3 2 2 2 2 2 2 3 2 3 3 2 3 2 3 2 2 2 3 2 2 2 2 3 2 3 2 3 2
 [2449] 3 3 2 2 2 2 3 3 3 2 2 3 2 2 2 2 2 3 2 2 2 3 2 2 2 2 3 2 2 2 3 2 2 2 2 1
 [2485] 2 2 2 2 3 2 2 2 2 2 2 2 2 2 3 3 3 3 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 3
 [2521] 2 2 2 3 3 3 2 2 2 2 2 2 3 3 2 3 2 2 2 2 2 3 2 2 3 2 3 2 3 2 2 2 2 3 2 2
 [2557] 3 2 2 3 3 2 2 1 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 3 3 2 2 2 3 2 2 3 2
 [2593] 2 3 3 2 3 3 3 2 3 2 3 3 2 2 3 2 2 2 2 3 2 2 3 2 3 2 2 3 2 2 3 2 2 3 2 2
 [2629] 3 3 2 2 2 2 2 3 3 3 3 2 2 2 2 3 2 2 3 2 2 2 3 2 3 2 2 2 2 2 2 3 3 2 3 1
 [2665] 2 3 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2
 [2701] 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 3 2 2 2 3 2 2 3 2 2 2 2 3 2 2 3 2 2 2 2
 [2737] 3 3 2 2 2 2 2 3 3 2 3 3 2 2 2 2 3 2 3 2 2 2 3 3 3 3 2 2 2 2 3 2 3 3 2 2
 [2773] 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 3 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2
 [2809] 2 3 3 2 2 2 2 2 2 3 2 3 2 3 2 2 2 2 2 2 3 3 2 2 3 2 3 2 2 2 2 2 3 3 2 3
 [2845] 2 2 2 2 3 3 3 2 3 2 3 3 2 2 2 2 2 2 2 2 2 2 3 2 3 3 3 2 3 3 2 3 2 2 2 2
 [2881] 3 3 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2 2 3 2 2 2 2 1 3 2 2 3 2 2 2 2
 [2917] 2 2 2 2 3 2 2 2 2 2 3 3 2 3 3 2 2 2 2 2 2 2 2 2 3 3 2 2 3 2 2 2 2 2 2 3
 [2953] 3 3 3 2 3 2 2 2 2 2 2 3 3 3 2 2 2 2 3 3 3 2 3 3 2 2 3 2 2 2 2 2 2 3 3 3
 [2989] 2 2 2 2 3 2 2 2 2 3 3 2 2 3 2 2 2 2 2 2 3 2 3 3 2 3 3 3 2 3 2 3 2 2 2 2
 [3025] 2 3 2 3 2 2 2 2 2 2 3 3 2 2 2 2 3 2 2 3 2 2 2 2 1 2 3 2 3 2 2 2 2 2 2 2
 [3061] 2 3 2 3 3 2 2 2 2 2 2 2 3 3 2 2 2 2 2 2 2 3 2 3 2 2 2 2 3 3 3 3 2 2 3 2
 [3097] 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 3 2 2 2 3 2 3 2 2 2 3 3 2 3 3 2 3 3 2
 [3133] 3 2 2 2 2 3 3 3 3 3 2 2 3 3 2 3 2 2 2 2 2 3 2 3 3 2 3 2 2 2 3 2 3 2 2 2
 [3169] 2 2 2 2 2 2 2 3 2 2 2 3 3 3 2 3 2 2 2 2 3 2 3 3 3 2 1 2 3 3 2 2 2 2 3 2
 [3205] 3 3 2 2 2 3 3 2 2 3 2 3 2 2 2 2 2 2 2 2 3 2 2 2 3 3 2 2 3 2 2 2 2 3 3 2
 [3241] 2 2 3 2 2 2 2 2 3 3 2 2 2 2 2 3 2 3 3 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2
 [3277] 2 2 2 2 2 2 3 2 3 2 2 2 3 3 3 2 2 2 2 2 2 3 2 2 2 2 3 2 2 3 2 2 2 2 3 2
 [3313] 3 3 3 3 2 3 3 2 2 2 2 3 3 2 2 3 2 2 3 3 2 3 3 2 3 3 3 2 2 2 2 2 3 2 2 2
 [3349] 2 3 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 2 3 2 2 3 2 2 2 2 2 2 3 2 2 3 2 2 2 3
 [3385] 3 2 2 2 2 2 2 2 2 3 3 2 2 2 2 3 2 3 2 2 2 3 3 2 3 2 2 3 3 2 3 1 2 2 3 2
 [3421] 3 2 3 3 2 2 2 3 2 3 2 3 2 2 2 2 2 2 2 2 2 3 3 2 3 2 2 2 2 2 3 3 3 2 3 2
 [3457] 2 3 3 2 3 3 2 2 2 2 2 2 3 2 3 2 2 2 3 3 2 2 3 3 3 2 2 2 2 3 3 2 2 2 3 2
 [3493] 2 2 3 3 3 3 2 3 1 2 2 2 2 1 2 2 3 2 2 2 2 2 3 2 3 2 2 2 2 2 3 2 2 2 2 3
 [3529] 2 2 2 2 3 2 3 3 3 3 2 3 2 2 2 2 2 2 2 3 2 3 3 2 2 2 3 2 2 3 3 3 2 2 3 2
 [3565] 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 3 2 2 3 3 2 2 2 3
 [3601] 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 2 2 2 1 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2
 [3637] 2 1 3 2 3 3 2 2 2 3 2 2 3 2 2 3 3 2 2 3 3 2 2 3 3 2 2 2 2 2 2 3 3 3 2 2
 [3673] 2 2 3 3 2 3 2 2 3 2 2 2 3 3 2 2 3 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 3
 [3709] 2 2 2 3 3 2 3 2 3 2 2 3 2 2 2 2 3 2 3 2 2 2 2 2 3 3 2 3 3 2 2 2 2 3 2 2
 [3745] 2 2 2 2 2 3 2 3 2 2 2 2 3 3 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3
 [3781] 2 3 3 3 2 2 2 3 3 3 3 2 2 2 3 2 2 2 3 3 3 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2
 [3817] 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 3 2 2 2 2 3 3 2 2 3 2 2 2 2 3 2 2 3
 [3853] 2 2 3 3 2 3 3 2 2 2 3 2 2 2 3 2 3 3 2 2 3 2 2 2 2 3 2 2 2 3 3 2 2 2 3 3
 [3889] 2 2 2 2 2 2 2 2 2 3 3 2 1 2 3 2 2 2 3 3 2 2 2 2 2 2 3 3 2 3 2 2 2 2 2 2
 [3925] 2 2 3 2 3 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 2 2 3 2 3 2 2 2 3
 [3961] 2 3 2 2 2 2 2 2 2 3 3 2 2 2 2 2 3 2 2 2 3 3 2 3 3 2 2 2 2 2 3 2 3 2 2 3
 [3997] 2 2 3 2 2 3 2 2 3 2 2 2 2 3 2 2 2 3 3 2 3 3 3 2 2 2 2 2 2 3 2 2 2 2 2 3
 [4033] 3 2 3 3 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 3 2 3 3 3 3 2 2 2 2 3 2 2 2 3 3 2
 [4069] 2 2 2 3 3 2 2 2 2 3 3 2 2 2 3 2 3 2 2 3 3 3 3 3 3 2 2 2 3 2 3 2 2 2 2 2
 [4105] 2 3 2 2 2 2 3 2 2 2 3 2 2 3 3 2 2 2 3 2 2 2 2 3 2 2 3 2 2 2 2 2 2 2 2 2
 [4141] 2 2 3 2 3 2 3 2 2 2 2 2 3 2 3 2 2 3 1 2 3 2 2 2 3 2 2 2 2 2 3 2 3 2 2 2
 [4177] 3 3 2 3 3 3 3 3 2 2 2 2 3 2 2 2 2 3 3 2 2 2 2 2 3 2 3 2 2 3 2 2 3 2 3 2
 [4213] 2 2 3 2 2 2 3 2 2 2 2 2 3 2 3 2 3 3 2 3 2 3 3 2 3 2 2 3 2 2 2 2 2 2 3 2
 [4249] 2 2 2 2 2 2 2 3 2 2 3 2 2 2 3 3 3 3 2 3 2 2 2 3 3 3 2 2 3 3 2 3 2 2 2 3
 [4285] 2 3 2 2 3 3 2 2 2 3 2 2 3 3 2 2 2 3 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 3
 [4321] 3 2 3 3 2 3 2 3 2 2 3 3 2 2 3 3 3 2 2 3 2 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2
 [4357] 2 3 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 2 2 2 2 3 2 3 2 2 2 2 3 2 2 2 3
 [4393] 2 3 2 2 2 2 2 2 3 3 2 2 2 3 2 2 3 3 2 2 3 2 2 3 2 2 2 3 3 2 2 3 2 2 2 2
 [4429] 3 2 3 2 2 2 2 3 2 2 2 3 2 2 2 2 3 2 2 3 2 2 2 2 2 3 3 3 2 2 1 3 3 2 2 2
 [4465] 2 2 2 2 2 2 2 2 2 3 2 3 2 3 2 2 2 2 2 3 2 2 2 3 3 2 3 2 1 2 3 2 2 2 2 2
 [4501] 2 2 3 3 3 2 3 2 3 3 2 2 2 2 2 2 2 1 2 3 2 2 3 2 2 2 3 2 2 3 2 1 2 2 2 3
 [4537] 2 2 2 3 2 2 2 3 2 2 3 2 2 2 2 2 3 2 2 3 3 2 2 3 3 3 2 3 2 3 2 2 2 2 2 2
 [4573] 3 2 2 2 2 3 2 2 2 2 3 3 2 2 2 2 3 2 2 2 2 3 2 2 2 3 2 2 3 3 2 2 2 2 2 2
 [4609] 2 2 2 3 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 3 2 3 2 2 2 3 3 2 2
 [4645] 2 3 2 2 3 3 3 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 3 2 2 3 3 3 2 3 2 2 2 3 2 3
 [4681] 3 2 3 2 2 3 3 2 2 2 2 2 2 2 3 2 2 2 3 3 2 2 2 2 2 2 3 2 3 2 3 2 2 2 2 2
 [4717] 2 3 3 3 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 3 2 2 3 3
 [4753] 2 2 3 3 2 2 2 3 2 2 3 3 2 3 2 2 2 2 2 3 2 2 2 3 3 2 2 3 2 2 2 2 3 2 2 3
 [4789] 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2
 [4825] 3 3 3 3 2 3 2 2 3 2 2 3 2 2 2 2 2 2 2 2 3 3 2 2 3 2 2 2 2 2 3 3 3 2 2 2
 [4861] 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 3 2 2 3 2 3 2 2 2 3 2 2 2 3 2 2 2 3 3 2 3
 [4897] 3 3 2 2 2 3 3 3 2 1 2 2 2 2 2 2 3 2 3 2 2 3 3 2 3 2 2 2 2 3 2 2 2 2 2 3
 [4933] 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2
 [4969] 2 2 3 2 2 3 2 2 2 2 3 2 3 3 3 2 3 3 2 3 3 3 3 2 3 2 1 2 2 2 2 3 2 2 3 3
 [5005] 3 2 3 2 2 3 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 2 3 3 2 3 2 3 2 3 2 2
 [5041] 3 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 3 2 2 3 2 2 3 2 3 2 3 3 2 3 2 3 2 2 2 2
 [5077] 2 2 3 2 2 3 2 2 3 2 2 2 2 2 2 3 2 2 3 3 3 2 3 2 2 2 2 3 2 2 2 3 2 3 2 3
 [5113] 2 3 2 3 3 2 3 3 2 3 2 3 3 2 2 3 2 3 3 2 2 2 3 2 3 3 2 2 2 2 2 2 3 3 3 2
 [5149] 2 2 2 3 2 2 2 2 2 3 3 3 2 2 2 2 2 3 2 3 3 2 2 3 2 2 3 2 3 2 2 3 3 3 3 3
 [5185] 2 2 2 3 2 2 2 3 2 2 3 2 3 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2
 [5221] 3 2 1 2 2 3 2 2 2 3 2 3 2 2 2 2 3 2 3 3 2 2 2 3 2 3 2 2 3 2 2 3 2 2 3 2
 [5257] 3 2 3 2 2 2 3 2 3 2 3 2 2 3 2 2 2 3 2 2 2 3 3 2 3 2 2 3 3 2 3 2 2 3 2 1
 [5293] 2 2 3 2 2 2 3 3 2 3 1 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2
 [5329] 2 2 3 3 3 2 2 3 2 2 3 2 2 2 2 2 3 2 2 3 3 2 2 3 2 2 2 2 3 2 3 3 3 2 2 2
 [5365] 2 2 2 3 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2 3 3 3 2 2 2 2 3 2 2 2 3 3 3 2 2
 [5401] 3 2 3 3 3 2 2 2 2 2 2 2 2 2 2 3 3 2 2 1 2 2 2 3 2 3 3 2 2 2 2 2 2 2 3 3
 [5437] 1 2 2 3 2 2 2 3 3 2 3 2 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 2 2 2
 [5473] 2 3 2 2 3 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 3 3 2 2 2 2 2 3 2 2
 [5509] 3 2 3 2 2 2 3 2 2 2 3 2 2 2 2 3 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2 3 3
 [5545] 2 2 2 2 3 3 1 2 3 3 3 2 2 2 2 2 2 2 3 2 3 2 2 2 3 2 2 2 3 3 3 2 2 2 2 3
 [5581] 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 3 3 2 2 2 2 3 2 3 2 1 2 2 2 3 2 2
 [5617] 2 3 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 3 2 2 2 2 2 2 2 3 2 2 3 2 2 3 3 2 3 2
 [5653] 2 2 2 2 3 3 2 2 3 2 2 2 3 2 2 3 3 3 3 3 2 2 2 2 3 2 2 2 2 3 2 2 2 2 3 2
 [5689] 3 3 2 2 2 2 3 2 2 3 2 2 3 3 2 2 2 2 2 3 2 3 3 3 3 2 2 2 2 2 2 3 3 3 2 2
 [5725] 3 2 2 2 2 2 3 2 3 2 3 3 2 3 2 3 3 2 3 2 2 2 3 3 3 2 2 2 2 2 3 3 2 2 2 3
 [5761] 2 3 2 2 3 2 2 2 2 2 2 3 2 2 3 2 2 2 2 2 2 3 2 3 2 2 3 2 2 2 3 2 3 3 2 2
 [5797] 2 2 2 2 2 2 2 3 2 2 2 3 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2
 [5833] 2 2 3 2 2 2 2 2 2 2 2 3 3 2 3 2 2 2 2 2 2 2 2 2 2 2 3 3 2 3 3 2 2 2 3 1
 [5869] 2 3 2 3 2 2 2 3 2 3 2 2 3 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 2 2
 [5905] 2 3 2 3 2 3 2 3 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 3 3 3 2 2 2 3 2 2 3 2 3 2
 [5941] 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 3 2 3 2 3 2 2 3 2 3 2 2 2 3 2 3 2 2 2 3 2
 [5977] 2 3 2 3 3 2 2 3 2 2 3 3 2 2 2 2 2 2 3 2 3 2 3 2 2 2 3 2 2 3 2 2 2 2 3 2
 [6013] 3 2 2 2 3 2 3 3 2 2 2 2 3 3 2 2 2 2 2 2 2 2 3 2 3 2 2 3 3 3 2 2 3 2 2 2
 [6049] 2 2 3 2 2 3 2 3 1 2 2 3 2 2 3 3 2 2 3 2 2 2 2 3 3 2 2 3 2 2 2 3 2 2 2 3
 [6085] 3 2 2 2 3 2 2 3 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 3 2 2 2 2 2 2 2 2 3 3 2 3
 [6121] 2 2 2 2 2 3 3 2 2 2 2 2 2 2 3 3 2 3 3 3 2 2 2 2 3 2 3 3 2 2 2 3 3 2 2 3
 [6157] 2 2 2 2 3 2 3 2 2 2 2 3 2 3 3 2 2 2 2 2 2 2 2 3 3 3 2 2 3 2 3 2 3 2 2 2
 [6193] 2 2 2 2 3 2 2 2 3 2 2 3 3 2 3 2 3 2 2 2 3 2 2 2 2 3 2 2 2 2 2 3 3 2 3 2
 [6229] 2 2 2 2 2 2 2 2 3 3 2 2 2 3 3 3 2 2 2 3 3 2 3 2 3 2 2 2 3 2 2 2 3 2 2 3
 [6265] 2 3 2 2 2 3 2 2 3 2 2 2 2 2 2 2 2 2 3 2 1 2 2 2 3 3 2 2 2 2 3 3 2 2 3 2
 [6301] 2 2 2 2 3 2 2 2 2 3 3 3 2 2 3 2 2 2 2 3 3 3 2 3 2 3 2 2 2 2 2 2 2 2 3 2
 [6337] 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 3 3 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2
 [6373] 3 2 3 2 3 3 3 2 3 2 2 2 3 2 2 2 3 2 2 3 2 3 2 2 3 2 3 2 2 2 2 3 3 2 2 2
 [6409] 3 2 2 3 2 2 3 2 2 2 3 3 2 2 3 3 3 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 3 2 2
 [6445] 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2 3 3 2 2 2 2 2 2 2 2 2 2 2
 [6481] 2 3 2 3 2 2 3 2 3 2 3 3 3 3 2 3 3 2 3 3 3 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2
 [6517] 2 2 2 2 3 2 2 2 2 1 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 3 3 2 2 2 2 2 2
 [6553] 2 2 2 2 2 3 2 2 2 3 2 3 2 2 3 3 1 2 2 2 2 2 2 3 3 2 2 2 3 2 2 2 2 2 2 3
 [6589] 2 2 3 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2
 [6625] 2 3 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 1 2
 [6661] 2 2 3 2 2 2 2 3 3 3 2 2 2 3 3 2 2 2 2 2 2 2 3 2 2 3 2 2 2 3 2 2 3 2 3 3
 [6697] 3 2 2 3 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 3 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2
 [6733] 2 2 3 3 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 3 2 2 2 2 2 3 2 3 2 3 3 3 2 3 2
 [6769] 3 3 2 2 2 2 2 2 3 2 2 2 2 3 3 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 3 2 2 2 2 3
 [6805] 2 3 2 2 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2 3 3 2 2
 [6841] 2 2 2 2 2 2 3 2 2 2 3 2 2 3 2 2 2 2 3 2 2 2 2 2 3 3 2 2 2 3 3 3 2 3 2 2
 [6877] 3 2 2 2 2 3 3 3 2 2 2 3 2 3 3 2 3 2 3 2 2 3 2 2 3 3 3 2 2 2 3 2 2 3 2 2
 [6913] 2 3 2 2 2 3 3 2 3 2 2 2 2 3 2 2 2 2 3 2 3 3 2 2 2 3 2 3 3 2 2 2 2 2 3 2
 [6949] 2 2 3 2 3 2 2 2 2 3 2 2 3 2 2 2 3 2 2 3 2 2 2 3 2 3 2 2 2 2 2 3 2 3 2 2
 [6985] 2 2 2 2 3 2 3 3 3 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2 2
 [7021] 2 2 2 2 2 2 2 3 3 2 2 2 3 2 3 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2
 [7057] 3 2 3 2 3 2 3 2 2 3 3 2 2 2 2 3 2 2 2 3 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2
 [7093] 3 2 2 2 2 3 2 2 3 3 3 2 2 2 3 2 2 2 3 2 3 2 2 2 2 2 3 3 2 2 2 2 2 2 2 3
 [7129] 2 3 3 2 2 2 2 2 2 3 3 2 2 3 2 3 1 2 2 3 2 2 3 3 2 3 3 2 2 2 2 3 2 2 2 2
 [7165] 2 2 2 2 2 3 2 3 3 2 2 3 3 2 2 2 2 3 2 2 2 2 3 2 2 2 2 2 3 3 2 2 3 2 3 3
 [7201] 2 2 1 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 3 2 3 2 3
 [7237] 2 2 2 3 3 2 2 2 2 3 2 2 2 3 2 2 2 3 2 3 2 2 3 2 2 2 2 2 3 2 2 2 2 3 2 3
 [7273] 3 3 3 2 2 2 2 3 2 2 3 3 2 2 2 2 3 2 3 3 2 3 2 2 2 3 2 3 2 2 2 3 2 3 3 2
 [7309] 3 3 2 2 2 2 2 3 2 2 2 2 3 3 3 2 2 2 3 2 3 2 2 2 2 2 2 2 3 3 2 2 2 2 3 2
 [7345] 3 2 3 2 3 2 2 3 2 2 3 2 2 3 3 2 2 3 3 2 2 3 2 2 2 2 2 2 2 3 3 2 3 2 2 2
 [7381] 2 3 3 2 3 2 2 2 2 2 3 2 3 2 3 2 2 2 3 2 2 3 3 3 3 2 2 2 2 2 3 2 2 2 3 2
 [7417] 2 2 2 3 3 2 2 3 2 3 3 3 2 2 2 2 2 3 2 3 2 2 2 2 3 2 3 2 2 2 2 2 2 3 2 3
 [7453] 3 2 3 3 3 3 2 2 3 2 3 2 2 2 2 2 3 3 3 3 2 2 2 2 3 2 2 2 2 2 2 2 3 2 3 2
 [7489] 2 3 2 2 2 3 3 3 2 3 3 2 2 2 2 2 3 3 2 3 2 2 2 3 3 3 3 3 2 2 2 2 2 2 2 3
 [7525] 2 3 2 2 2 2 2 2 3 2 3 2 2 3 3 3 3 2 2 3 2 2 2 3 2 2 2 3 2 2 3 2 3 2 3 2
 [7561] 3 3 2 3 2 3 2 2 2 3 3 3 2 2 2 2 2 2 2 2 2 3 2 2 3 3 3 2 3 3 3 1 2 3 2 3
 [7597] 3 2 2 3 2 2 3 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 3 2
 [7633] 2 2 2 2 2 2 2 2 2 2 2 3 3 3 2 2 3 2 2 2 2 2 2 3 2 3 3 2 2 2 2 2 2 3 2 2
 [7669] 2 3 2 3 3 2 2 2 3 2 2 2 3 3 2 3 2 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 2
 [7705] 2 2 2 2 2 2 3 2 1 3 3 2 2 2 2 3 3 2 2 2 2 3 2 3 3 2 3 3 2 3 2 2 2 2 2 3
 [7741] 3 2 3 3 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 3 2 3 2 2 3 2
 [7777] 2 2 2 2 2 3 2 2 3 3 2 2 2 2 3 3 2 2 3 2 3 3 2 2 3 2 2 3 2 3 2 2 2 2 3 2
 [7813] 2 2 2 2 3 2 2 2 2 3 2 3 3 3 2 3 2 2 2 2 2 3 2 2 2 3 2 3 2 2 3 2 2 2 2 2
 [7849] 2 3 3 3 2 3 2 3 2 2 2 2 2 2 2 2 3 2 2 3 3 2 3 2 2 3 2 3 2 2 2 2 2 2 2 2
 [7885] 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 3 2 2 2
 [7921] 2 2 3 2 2 2 3 2 2 3 1 2 2 2 3 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 3 2 3 2 3 3
 [7957] 2 2 2 2 3 2 3 2 2 3 3 3 3 2 3 3 3 2 2 2 2 2 2 3 2 2 1 2 3 3 2 2 2 2 3 2
 [7993] 2 3 3 2 2 2 2 3 2 2 3 2 3 2 2 3 3 3 3 2 3 2 2 2 3 2 2 2 3 3 2 2 2 3 3 2
 [8029] 3 2 2 3 3 2 1 3 3 2 2 2 3 2 2 2 2 2 2 2 3 2 3 2 3 3 2 3 3 2 2 2 2 2 3 2
 [8065] 2 3 3 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2 2 2 3 2 3 3 2 2 3 2 2 2 2 2
 [8101] 3 2 2 2 3 2 3 3 2 3 2 2 2 3 2 2 2 2 2 2 3 2 2 2 1 3 3 3 2 2 2 3 3 2 2 2
 [8137] 2 2 2 2 2 3 2 3 2 3 2 2 2 3 2 3 2 2 2 2 2 2 3 3 2 3 2 2 2 2 2 2 2 2 3 2
 [8173] 2 3 2 2 2 2 2 2 3 2 3 2 2 2 1 2 3 2 2 3 2 2 2 2 2 3 3 2 2 2 3 2 2 2 3 2
 [8209] 2 3 3 3 2 2 2 2 2 3 3 3 2 2 3 3 2 2 3 2 2 3 2 3 2 2 2 2 3 3 3 2 3 2 2 3
 [8245] 2 3 2 2 2 1 2 3 2 2 2 2 3 2 2 2 2 2 2 2 3 3 2 2 2 2 2 3 2 3 2 2 3 2 3 2
 [8281] 2 2 2 2 2 2 3 2 3 2 3 2 2 2 2 2 2 3 2 2 2 3 3 3 2 3 2 3 2 3 2 2 2 2 2 3
 [8317] 2 3 2 3 2 2 2 2 3 2 2 1 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 3 2 2 3 2
 [8353] 3 2 3 2 3 3 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2
 [8389] 2 2 3 2 3 2 3 2 2 3 2 2 2 2 3 2 3 2 2 2 3 2 2 3 2 3 2 2 2 2 3 3 2 3 3 2
 [8425] 2 3 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 3 2 2 3 3 2 2 2 3 3 2
 [8461] 2 3 3 3 2 2 3 2 2 3 2 2 2 2 3 2 2 2 2 2 1 2 2 2 2 3 3 3 2 2 2 2 2 3 2 1
 [8497] 2 2 2 3 3 2 2 2 2 2 3 3 3 2 3 2 2 2 3 2 2 3 2 2 2 3 2 2 2 2 2 2 2 3 2 2
 [8533] 2 2 2 2 2 3 2 3 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 2 2 2 3 2 2 2 3 2 3 2 2 3
 [8569] 2 2 2 2 2 2 2 3 2 2 2 2 2 3 3 3 2 3 3 2 2 3 3 2 3 2 2 3 3 2 2 2 3 2 2 2
 [8605] 3 3 3 3 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2 3 3 2 2 2 3 3 3 3 2 3 2 2 2 1 2 2
 [8641] 2 3 3 2 2 2 2 3 3 3 2 2 2 2 3 2 2 3 2 2 3 2 2 2 3 3 3 2 3 3 1 2 3 3 3 3
 [8677] 2 2 2 2 2 2 2 2 2 2 3 3 2 3 3 2 2 3 2 2 3 2 2 2 3 3 2 3 2 2 3 3 3 2 2 3
 [8713] 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 3 3 2 2 2 2 3 3 3 3 3 3 2 2 2 2 3 2 3 2 2
 [8749] 2 3 2 2 2 2 2 2 2 2 2 3 2 2 3 3 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2
 [8785] 2 2 3 2 2 3 2 3 2 3 2 3 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 3 2 2 3 2 2 2
 [8821] 2 3 2 2 2 2 2 3 3 1 3 3 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 3 3 2 2 2
 [8857] 2 2 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 3 3 2 2 3 2 2 2 2 2 2 3 2 2 2 3 2 2 2
 [8893] 2 2 2 2 3 3 2 2 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 3 2 2 2 2 2 2 2 2 3 3 2 3
 [8929] 2 2 2 3 2 2 2 3 2 2 3 3 2 2 3 2 2 2 2 2 2 3 2 2 2 2 3 1 3 2 2 2 2 2 2 2
 [8965] 2 3 2 2 3 3 2 2 3 2 3 3 3 2 2 2 2 2 2 2 2 3 2 3 3 2 2 3 3 2 3 2 2 2 2 3
 [9001] 2 3 3 2 3 3 2 2 3 2 2 3 3 2 2 2 2 3 2 2 2 2 2 2 2 3 3 2 2 2 2 3 2 3 3 2
 [9037] 2 3 2 2 2 2 2 2 2 3 3 3 2 2 3 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2
 [9073] 2 2 3 2 2 3 2 2 2 2 2 2 2 3 3 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2
 [9109] 2 2 2 3 3 3 3 2 2 2 2 3 3 3 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 3 2
 [9145] 3 2 2 3 3 2 2 2 2 3 2 2 3 2 3 3 2 2 2 2 2 2 2 2 2 3 2 1 3 2 2 2 1 2 3 3
 [9181] 3 2 2 2 2 2 2 2 2 2 2 3 3 3 3 2 2 2 2 2 2 3 2 2 2 3 2 3 3 3 2 2 2 3 3 2
 [9217] 2 3 2 2 2 3 3 2 3 3 2 3 2 3 2 2 2 2 3 2 3 3 2 3 3 3 3 2 3 2 2 2 2 2 2 2
 [9253] 2 3 2 2 3 3 2 2 2 3 2 2 3 3 2 2 2 2 3 2 2 3 3 2 2 2 2 2 3 2 2 2 2 2 2 2
 [9289] 3 2 2 2 2 2 2 3 2 2 3 2 2 2 2 2 2 2 3 2 2 2 3 2 2 3 2 2 2 2 2 3 2 3 2 2
 [9325] 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 1 3 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3 3 2
 [9361] 2 2 3 2 2 2 3 1 2 2 2 3 2 2 3 2 2 3 2 3 3 2 2 3 2 3 2 2 2 3 3 3 2 2 2 2
 [9397] 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 3 3 3 3 2 2 2 3 2 2 2
 [9433] 2 2 2 3 2 3 3 3 2 2 2 2 2 3 2 3 2 3 2 2 3 2 2 2 2 3 2 3 2 3 2 2 3 2 3 3
 [9469] 2 2 2 2 2 2 2 3 3 2 3 2 3 2 2 2 2 3 2 2 2 2 2 3 2 3 2 2 2 2 2 3 2 2 2 3
 [9505] 3 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 3 3 2 2 3 2 2 2 3 2
 [9541] 2 3 2 2 2 2 2 2 3 2 2 2 3 2 3 2 3 2 2 2 2 2 3 2 3 3 2 3 2 2 2 3 2 2 2 2
 [9577] 2 2 2 2 3 2 2 2 3 3 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 3 3 2 2 3
 [9613] 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 3 2 3 2 2 2 3 3 3 3 2
 [9649] 2 2 2 2 2 2 3 2 2 3 2 2 3 2 2 3 2 3 2 2 3 2 2 3 2 3 2 2 2 2 2 2 3 2 2 2
 [9685] 2 2 2 2 2 3 3 3 2 2 2 2 2 3 3 3 2 3 2 2 3 2 3 3 3 2 3 2 2 2 2 2 2 3 3 2
 [9721] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 3 3 3 3 3 3 2 2 2 3 2 3 2 2 3 3 2 3
 [9757] 2 3 3 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 3 2 3
 [9793] 2 2 3 2 3 3 3 3 2 3 2 3 2 2 2 3 3 3 2 3 3 2 2 2 2 3 2 2 2 2 2 2 3 2 3 3
 [9829] 2 3 2 2 2 3 2 2 3 2 2 2 3 2 2 2 3 2 2 3 2 2 2 3 2 3 3 2 2 2 2 3 3 2 3 3
 [9865] 2 2 2 2 3 3 2 2 2 3 3 2 3 2 2 2 2 2 2 3 2 1 2 2 2 3 2 2 2 2 2 2 2 3 2 2
 [9901] 2 3 3 2 3 2 2 1 3 2 2 2 2 2 2 2 2 2 3 3 3 2 2 3 3 2 2 3 2 2 2 2 3 2 2 3
 [9937] 2 2 3 2 2 2 2 2 3 3 2 2 2 3 3 2 2 3 2 2 2 2 3 2 2 2 2 2 3 3 2 3 3 2 3 2
 [9973] 3 2 3 2 3 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
[10009] 3 2 2 2 2 2 2 2 3 3 3 2 3 2 2 2 3 3 3 2 3 2 2 2 2 2 3 3 2 3 2 2 2 2 3 3
[10045] 2 2 3 3 3 2 2 3 2 3 2 3 2 3 2 2 3 2 2 3 2 2 3 3 2 2 3 2 2 3 2 3 2 3 1 3
[10081] 3 2 3 3 3 2 3 2 3 3 2 2 2 2 2 3 2 3 2 2 3 3 3 2 2 3 2 2 2 2 3 2 3 2 3 3
[10117] 2 2 3 3 2 2 3 2 2 2 2 3 2 2 3 2 2 2 2 3 2 2 3 2 2 2 3 2 2 2 2 2 3 2 3 3
[10153] 2 2 2 2 2 2 2 2 3 2 3 2 2 3 2 3 2 3 2 3 3 2 2 2 2 2 2 2 2 2 3 3 3 2 2 3
[10189] 2 2 2 2 3 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 3 3 3 3 2 3 2
[10225] 3 2 3 2 2 3 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 3 3 2
[10261] 2 2 2 2 2 2 3 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 3 3 2
[10297] 2 2 2 2 2 3 3 2 2 3 2 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2
[10333] 2 2 2 2 2 2 3 2 3 2 2 3 2 2 3 2 2 2 2 3 3 2 3 2 2 3 2 2 2 2 2 2 2 3 2 2
[10369] 2 3 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 3 2 3 2 3 2 2 2
[10405] 2 2 2 3 3 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 3 2 3 2 2 3 2 2 2 2 2 2 2 2
[10441] 2 2 3 2 2 3 3 2 2 2 2 2 2 2 3 3 2 2 2 3 2 2 2 2 2 2 2 3 3 2 3 3 3 2 3 2
[10477] 2 2 3 2 3 2 2 2 2 2 2 3 3 2 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2
[10513] 3 2 3 1 2 3 2 2 3 2 3 2 2 3 2 2 3 3 2 2 3 3 2 3 2 2 3 2 2 3 2 3 2 3 3 2
[10549] 3 1 3 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 3 2 2 2 2 3 2 2 2 3 2 2 3 2 3 2 2 2
[10585] 2 3 2 3 2 2 2 2 2 3 2 2 2 2 2 3 3 2 3 2 2 3 2 2 3 2 2 2 3 2 2 2 2 2 2 3
[10621] 3 3 3 2 2 3 2 3 2 3 2 2 2 2 3 2 2 2 3 3 2 2 2 3 3 2 2 2 2 3 2 2 2 3 3 2
[10657] 2 2 2 2 3 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 3 2 2 3
[10693] 2 2 2 2 2 3 3 2 2 3 1 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2
[10729] 2 2 2 2 2 2 3 2 3 2 3 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2
[10765] 2 2 3 3 2 3 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 3 2 2 3
[10801] 2 2 2 2 3 3 2 2 3 3 3 3 3 3 2 2 2 2 3 3 2 3 3 3 2 2 2 3 2 2 3 3 2 2 2 3
[10837] 2 3 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3 2 3 3 2 3 2 2 3 3 2 2 2 2 2 3 2 2
[10873] 2 3 2 2 2 2 3 2 2 3 2 2 2 2 3 3 2 2 2 3 3 2 2 2 2 2 2 2 2 1 3 3 2 2 2 3
[10909] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 2 2
[10945] 2 2 3 2 3 3 3 2 2 3 2 2 2 3 3 2 2 2 2 3 3 2 3 2 3 2 2 3 3 3 2 2 3 2 3 2
[10981] 2 2 3 3 2 2 2 3 2 2 2 3 2 2 2 3 3 3 2 2 2 2 3 3 2 3 3 2 2 2 3 3 3 2 2 3
[11017] 3 2 2 2 3 2 3 3 2 2 2 2 2 2 2 2 3 2 3 2 2 2 3 2 2 2 2 3 3 2 2 2 2 2 2 2
[11053] 2 2 3 2 2 2 2 2 2 2 3 2 2 3 2 2 3 3 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2 3 2 3
[11089] 2 3 2 2 3 2 2 3 3 3 2 2 2 2 2 3 2 3 3 2 3 2 2 2 3 2 2 2 2 3 3 2 3 2 2 2
[11125] 2 2 3 2 3 3 2 2 2 3 2 2 2 2 3 3 2 2 3 2 2 3 2 2 3 2 2 3 2 3 3 2 2 2 3 3
[11161] 2 2 2 3 2 2 2 2 2 2 3 3 2 3 3 2 3 2 3 3 2 2 3 2 2 2 2 2 2 3 3 2 2 2 2 2
[11197] 2 2 3 2 2 2 3 2 2 2 2 2 3 2 3 3 3 3 3 2 2 2 2 2 2 3 2 2 3 2 3 2 2 2 2 2
[11233] 2 2 3 2 2 2 2 2 3 3 2 2 3 3 3 2 3 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2
[11269] 3 2 2 3 2 2 3 2 2 2 3 2 2 2 3 2 3 2 2 1 3 2 2 3 2 2 2 3 2 3 2 2 2 2 3 2
[11305] 2 3 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 3
[11341] 3 2 2 2 2 3 3 2 2 2 2 2 2 3 2 3 2 2 2 2 2 3 3 3 2 2 2 2 3 2 3 2 2 2 2 3
[11377] 2 3 2 2 2 3 2 2 2 2 3 2 2 3 2 2 2 2 2 3 2 3 2 2 2 2 2 3 2 2 2 2 3 3 2 2
[11413] 2 2 2 2 3 2 3 3 3 3 2 3 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
[11449] 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 2 3 3 2 2 2 3 2 2 3 3 2 2 2 2 2 3 3 3 2
[11485] 2 2 3 3 3 3 2 2 2 3 2 2 2 2 3 2 3 3 2 2 2 2 2 3 2 2 2 2 3 2 3 3 2 2 1 2
[11521] 3 2 2 3 2 2 3 2 3 3 3 3 3 2 2 3 3 3 2 2 2 2 3 2 3 3 2 2 2 3 2 2 2 3 3 3
[11557] 2 3 3 2 2 2 3 2 2 2 3 2 3 2 3 3 2 3 2 2 2 2 2 3 2 2 2 3 2 3 2 2 3 2 2 2
[11593] 2 2 2 2 2 2 2 2 3 2 3 3 3 2 2 2 3 3 2 2 2 2 2 2 3 2 3 2 2 2 2 3 2 2 3 1
[11629] 3 3 2 2 3 3 3 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 3 3 2 2 2 3 2 2 2 2 3 2 3 3
[11665] 2 2 2 3 3 2 2 2 2 2 3 3 3 2 2 2 2 3 3 2 3 2 3 2 3 3 2 2 3 2 2 2 3 2 2 2
[11701] 2 2 2 3 2 2 3 2 2 3 3 2 3 3 2 2 3 2 2 3 2 2 3 2 2 2 2 2 3 2 2 2 2 3 2 2
[11737] 3 2 2 3 3 2 2 2 2 2 3 3 3 2 2 2 3 2 2 1 3 3 3 2 2 2 3 2 2 3 2 2 2 2 3 3
[11773] 2 2 2 2 3 2 3 2 3 2 3 3 2 2 2 2 2 3 2 2 2 3 2 3 2 3 3 2 3 2 3 2 3 2 2 3
[11809] 3 3 2 3 2 3 2 3 2 2 2 2 3 3 3 3 2 3 3 2 3 2 2 3 2 2 2 3 3 3 3 3 2 2 2 2
[11845] 3 2 3 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2
[11881] 2 2 2 2 3 2 3 2 3 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 3 3 2 2 3 2 3 2 2 2 3 2
[11917] 2 3 3 2 3 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 3 2 2 2 3 2 2 3 2 3 2 2 2 3 2
[11953] 2 2 2 2 3 2 3 2 2 3 2 3 2 2 3 2 2 2 2 2 2 2 3 2 3 2 2 2 3 2 3 2 2 3 2 3
[11989] 2 2 2 2 2 3 3 2 2 2 2 3 2 3 2 2 3 3 3 3 2 2 2 3 2 2 3 3 2 2 2 2 2 3 2 3
[12025] 2 2 2 3 2 3 3 2 2 3 2 2 2 2 2 2 2 2 3 2 2 3 3 3 2 3 2 2 3 2 2 3 2 3 2 3
[12061] 2 2 3 2 2 2 2 3 2 2 2 3 2 2 2 2 3 2 2 2 3 3 2 2 2 2 2 2 3 2 2 3 3 2 2 2
[12097] 3 1 2 2 2 3 2 3 2 2 2 3 2 2 2 3 2 2 2 2 2 2 3 3 2 2 3 2 2 2 3 3 2 3 2 2
[12133] 2 2 2 2 2 3 3 2 3 2 2 2 2 2 2 3 3 2 2 3 2 3 2 2 2 2 2 3 2 2 2 3 3 2 2 3
[12169] 2 2 2 2 2 2 3 3 2 2 2 2 2 3 3 3 3 2 2 3 3 2 3 2 2 3 2 3 3 2 2 2 2 2 2 3
[12205] 2 2 3 2 2 3 2 2 2 2 3 2 3 2 3 2 3 2 3 3 2 2 2 3 2 3 3 2 2 2 3 2 2 3 3 2
[12241] 3 3 2 2 2 2 2 2 2 2 2 2 3 3 2 2 3 2 2 3 3 2 3 2 2 2 2 2 2 3 2 3 2 2 2 2
[12277] 2 2 2 3 2 2 2 2 3 3 3 2 2 2 3 2 2 2 3 2 3 3 2 2 3 2 2 3 2 2 2 3 2 3 3 2
[12313] 2 2 3 3 2 2 2 3 2 3 3 2 2 3 2 2 2 2 3 2 2 3 2 3 2 3 2 2 2 2 2 3 2 2 2 2
[12349] 2 2 2 1 3 3 2 3 3 3 2 3 2 2 2 2 2 2 1 3 2 3 2 2 3 2 2 2 2 2 2 2 3 2 2 2
[12385] 3 2 2 2 3 2 2 2 2 2 2 2 2 2 3 3 3 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 3 2
[12421] 2 2 2 2 2 3 2 2 2 3 2 2 3 2 3 3 2 2 3 2 3 2 2 2 3 2 2 2 2 2 2 2 3 3 3 3
[12457] 3 2 2 2 2 3 2 2 2 3 3 2 2 2 3 3 2 3 2 1 3 2 3 3 3 3 3 2 2 2 2 3 3 2 2 2
[12493] 3 2 2 3 2 3 2 3 2 3 3 2 3 2 3 2 3 2 2 2 2 3 3 2 2 2 2 2 3 2 3 2 2 2 2 3
[12529] 2 3 3 2 2 3 2 2 3 3 2 2 2 2 2 3 2 3 3 3 2 2 2 3 3 2 2 3 3 2 3 2 3 3 3 2
[12565] 2 3 3 3 2 2 3 2 2 2 2 2 3 2 3 3 2 3 2 2 2 2 2 2 2 2 3 2 3 3 3 2 2 3 2 3
[12601] 3 2 2 2 3 2 2 2 2 2 3 2 3 2 2 2 3 2 3 2 2 2 2 3 3 2 2 2 2 2 3 2 2 2 3 2
[12637] 3 3 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 2 2 3 2 2 3 2 2 2 2 3 2 3 2 3 3 3 2
[12673] 2 2 2 2 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2 2 2 3 3 2 3 2
[12709] 3 3 2 2 2 2 2 2 2 2 3 3 3 2 2 2 2 3 2 3 3 3 3 2 2 2 2 2 3 2 2 2 2 2 2 2
[12745] 2 3 3 2 2 3 3 2 2 2 2 2 2 2 3 2 2 2 3 3 2 3 2 2 2 2 2 3 2 3 2 2 2 3 2 2
[12781] 2 3 3 2 3 2 2 2 2 2 2 3 2 2 3 2 2 3 2 2 2 2 2 3 2 3 3 2 2 2 2 2 3 2 2 3
[12817] 2 3 2 3 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2 2 2 3 2 3 2 3 3 2 3 2 2 2 2 2 2 3
[12853] 2 2 2 3 2 2 2 1 2 2 2 2 3 2 2 2 2 2 3 3 2 2 2 2 2 3 3 2 2 3 2 2 3 2 2 2
[12889] 2 3 3 3 2 2 2 3 2 2 3 2 2 3 2 2 2 3 3 2 2 2 2 2 3 2 3 3 3 2 2 3 2 2 2 3
[12925] 3 2 2 3 2 2 2 2 2 3 2 2 2 3 3 2 2 2 2 2 2 3 3 3 3 2 2 2 3 3 2 2 2 2 3 2
[12961] 2 2 3 3 3 2 2 2 2 2 2 3 3 2 2 2 3 2 2 2 2 2 3 2 3 3 2 3 2 2 3 2 3 2 3 3
[12997] 2 2 3 2 2 2 2 2 2 2 3 2 2 2 3 3 3 2 2 2 3 2 3 2 3 2 3 2 2 2 2 2 2 2 2 3
[13033] 2 3 3 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 3 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2
[13069] 2 2 2 2 2 2 2 3 2 3 3 2 2 2 2 2 2 2 2 2 2 3 2 2 3 3 2 2 2 2 3 2 3 2 2 2
[13105] 3 3 2 2 2 2 2 2 3 3 2 3 3 3 3 2 3 3 2 2 2 3 3 3 3 2 2 2 2 2 2 2 2 2 2 2
[13141] 2 2 2 2 3 2 3 3 3 2 2 2 2 2 2 3 2 2 2 2 3 3 3 3 2 2 1 3 2 2 3 3 3 3 3 2
[13177] 3 3 2 2 3 3 3 2 2 3 2 2 2 3 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 3 3 2 2 3 2 3
[13213] 3 2 2 2 2 2 2 2 2 3 3 2 2 2 3 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 2 3 2 2 3
[13249] 2 2 2 3 3 2 2 2 2 3 2 2 3 2 2 3 3 3 2 2 2 3 2 2 2 3 3 2 2 2 3 2 2 2 2 2
[13285] 2 2 2 3 2 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2
[13321] 2 2 3 2 2 2 2 3 2 2 2 3 2 2 3 2 3 3 2 2 2 3 2 2 3 3 2 2 2 2 2 2 2 3 2 2
[13357] 2 2 2 2 3 3 3 3 2 2 3 3 2 2 2 3 3 3 2 2 2 2 2 3 2 2 2 3 3 3 3 2 2 3 2 3
[13393] 3 3 2 3 2 2 2 2 2 2 3 2 2 3 2 2 3 2 2 2 2 2 3 2 3 2 2 2 2 2 2 2 3 2 3 2
[13429] 3 2 3 3 2 2 3 2 3 2 3 2 3 2 2 2 2 2 2 2 1 3 3 2 3 2 2 2 2 3 2 3 3 3 3 2
[13465] 2 2 2 3 2 2 2 1 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 3 2 2 3 1 2 3 3
[13501] 3 2 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 2 3 3 2 2 3 3 2 2 3 3 2 2 3 2 3 2 3 2
[13537] 2 2 2 2 3 2 3 3 2 3 2 2 3 3 3 2 2 2 2 3 3 2 2 3 2 3 3 2 1 2 3 2 2 2 2 3
[13573] 3 3 2 3 3 2 2 2 2 3 3 2 2 2 2 3 2 2 3 2 2 2 3 2 2 2 2 2 2 2 3 3 2 2 2 2
[13609] 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 3 2 3 2 2 2 2 2 2
[13645] 3 2 2 2 2 2 2 3 2 2 3 2 2 3 2 2 2 2 2 2 2 3 3 2 2 2 2 3 2 2 2 3 2 3 2 3
[13681] 2 2 2 2 3 3 2 3 2 2 3 2 2 3 2 2 2 2 3 3 3 3 2 2 3 2 2 3 3 3 3 2 2 2 2 3
[13717] 2 2 3 2 2 2 2 2 2 2 2 2 2 3 3 3 2 2 3 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3
[13753] 3 3 3 3 2 2 2 3 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3 3 2 2 3 3 2 2 3 3 3
[13789] 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 2
[13825] 2 2 2 2 2 3 3 2 2 3 3 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2 3 2 3 2 2 2
[13861] 2 2 2 3 2 2 3 2 2 2 2 3 3 3 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 3 2 2 2 3 2 2
[13897] 2 2 2 3 3 3 3 3 2 3 3 2 3 3 3 2 3 2 2 2 2 2 3 2 2 3 2 2 2 2 2 3 2 2 3 2
[13933] 2 2 2 2 2 3 2 3 2 2 3 2 3 2 2 3 2 2 2 2 2 3 3 2 2 3 3 3 3 2 3 2 2 2 3 2
[13969] 3 2 2 2 2 3 3 3 3 3 3 2 2 2 2 2 3 2 2 3 2 2 3 2 2 2 2 2 3 2 3 2 2 2 3 2
[14005] 3 3 2 2 3 3 2 2 2 2 3 2 2 3 3 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 3 2 2 3 2
[14041] 2 3 3 3 2 3 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2 3 3 2 3 2 3 2 2 2
[14077] 2 3 3 2 3 2 3 3 2 3 2 2 3 2 3 2 2 2 3 2 2 3 3 3 2 2 3 2 3 3 2 3 2 3 2 3
[14113] 2 2 2 2 3 3 2 2 3 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 3 2 2 3 2 2 2 3 2 2
[14149] 3 2 2 3 3 3 2 2 2 3 2 2 3 2 2 2 2 3 2 2 2 3 2 2 2 3 3 2 2 2 2 3 3 2 2 3
[14185] 3 2 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 3 3 2 3 3 2 3 2 2 2 2 2 2 3 2 3 2
[14221] 3 2 3 2 2 3 2 3 3 3 2 3 2 3 2 2 3 2 3 2 2 2 3 2 2 2 2 2 2 2 2 2 3 2 2 3
[14257] 2 2 2 3 3 2 2 2 3 2 2 3 3 2 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2 3 3 2 2
[14293] 2 2 3 3 2 3 3 2 2 3 3 2 3 2 2 2 2 2 2 2 2 3 3 3 2 2 3 2 3 2 2 2 3 3 2 2
[14329] 2 2 2 2 3 2 2 3 3 3 2 3 2 2 2 2 3 2 2 3 2 3 2 2 2 2 3 2 2 2 3 3 3 2 2 3
[14365] 2 2 2 2 2 3 2 2 2 3 2 3 2 2 2 3 3 2 3 2 3 3 2 2 3 2 2 2 3 3 2 3 3 2 2 2
[14401] 2 2 3 2 3 3 2 2 3 3 3 2 2 3 2 2 3 2 3 3 2 3 2 2 2 3 2 2 2 2 3 2 3 2 2 3
[14437] 3 2 2 2 2 2 3 3 2 3 2 2 3 3 2 2 3 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 3 2 3 2
[14473] 2 2 2 2 2 2 3 2 2 3 2 2 3 3 2 2 2 2 3 2 2 3 2 2 2 2 2 2 2 3 2 3 3 2 3 3
[14509] 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 3 2 2 3 2 2 2 2 3 2 3 2 2 2 2 2 3
[14545] 2 2 2 2 3 2 2 2 2 2 2 3 2 3 3 2 2 2 3 3 3 2 2 3 3 2 2 2 2 2 2 2 3 2 2 2
[14581] 2 3 3 2 3 3 2 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 1 3 3 2 2 3 3 2 2 2 2 3 2
[14617] 3 2 2 3 2 3 2 2 3 2 3 2 2 2 2 3 3 2 3 3 3 2 3 2 2 2 3 2 2 3 2 2 2 2 2 2
[14653] 3 2 3 2 2 2 2 2 3 3 2 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 3 2 2 2 2 2 2 2 3 3
[14689] 2 3 2 3 3 3 2 3 3 2 2 2 3 2 3 3 2 2 2 3 2 3 2 2 3 3 3 2 3 2 2 3 3 2 2 2
[14725] 3 3 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2 3 2 3 2 2 3 3 2 2 2 2 2 2 2 2 2 2
[14761] 2 2 2 3 2 2 3 3 2 3 2 3 3 3 2 3 3 3 2 2 3 3 2 2 3 2 2 2 2 3 2 3 2 2 3 3
[14797] 2 2 2 2 2 2 2 2 3 3 2 2 3 3 2 2 3 3 2 2 2 3 2 3 2 2 3 2 2 3 3 2 3 2 2 2
[14833] 2 2 2 3 3 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 3 2 2 3 2 2 3 2 2 2 3 2
[14869] 2 2 3 2 2 2 3 2 2 3 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 1 2 2 2 3 2 2 3 2 2 2
[14905] 2 2 2 2 2 3 2 2 2 2 3 2 2 3 2 2 3 3 3 2 2 2 2 3 3 3 3 2 2 3 2 2 2 2 2 3
[14941] 2 2 2 2 1 2 3 2 2 2 2 2 2 3 2 2 2 3 3 3 3 2 2 3 2 2 3 3 3 2 3 2 2 2 2 2
[14977] 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 3 2 2 2 2 3 2 3 3 2 3 3 3 3
[15013] 3 2 2 3 3 2 2 2 2 2 2 2 3 1 2 2 3 2 2 2 2 3 3 2 2 2 2 2 2 3 3 3 3 2 2 2
[15049] 2 2 3 2 2 2 2 2 3 3 3 2 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 3 2 3 2 3
[15085] 2 2 2 3 2 2 2 2 2 2 2 3 2 3 2 3 3 2 2 3 3 2 2 2 2 2 3 2 3 2 2 2 2 2 2 1
[15121] 3 2 3 2 2 2 3 2 2 3 2 3 2 3 3 2 2 2 2 2 2 3 2 2 2 2 3 3 3 2 3 2 2 2 2 2
[15157] 3 2 2 3 2 1 3 2 2 2 2 2 2 2 3 2 3 3 2 2 3 2 2 2 2 3 2 2 2 2 3 3 3 2 2 2
[15193] 2 2 3 3 2 3 2 2 3 2 2 2 3 2 2 3 3 2 3 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3
[15229] 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 3 2 3 2 2 3 2 3 2 2 2 2 2 3 2 3 2 2 3 2 2
[15265] 3 2 2 2 2 2 2 2 2 2 3 2 3 3 2 2 2 2 2 2 3 2 2 3 3 3 2 2 2 2 3 3 3 3 2 2
[15301] 2 2 3 2 3 3 3 2 2 2 2 2 2 3 3 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 3 2
[15337] 3 2 2 2 2 3 2 3 2 3 2 2 2 2 2 3 3 3 2 3 2 2 2 3 3 3 2 3 3 3 2 2 2 2 3 2
[15373] 2 2 3 3 3 2 3 3 2 3 3 3 3 3 2 2 2 3 2 2 3 2 2 2 2 3 3 3 2 2 2 2 2 3 2 2
[15409] 2 2 2 2 2 2 3 2 2 2 2 3 2 2 3 2 2 3 3 2 3 3 2 2 2 3 2 2 3 3 2 2 2 2 3 2
[15445] 3 2 2 3 2 3 2 2 2 2 2 2 3 2 2 3 2 2 3 2 2 2 3 2 3 2 2 3 2 2 2 2 2 2 2 3
[15481] 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 3 3 3 3 2 2 2 2 3 2 3 2 3 2 3
[15517] 2 3 2 2 2 2 2 3 2 2 2 3 3 2 2 3 2 2 3 2 2 2 2 3 3 3 2 2 2 2 3 2 3 2 2 2
[15553] 2 2 3 2 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2 2 2 3 2 2 2 2 3
[15589] 3 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 3 3 2 2 2 2 2 3 2 3 3 2 2 2 3 2 2 2 3 3
[15625] 3 3 3 2 2 2 2 2 2 3 2 3 3 3 2 3 1 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 2 3
[15661] 2 3 2 2 2 2 3 2 2 3 2 2 2 3 3 2 2 3 3 2 2 2 2 3 3 3 2 2 2 2 2 2 2 3 3 2
[15697] 2 3 2 2 2 2 2 3 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2
[15733] 2 2 2 2 2 2 2 3 2 2 2 3 2 2 2 3 2 3 2 2 3 1 3 2 2 2 2 2 2 2 2 2 2 3 2 2
[15769] 2 3 3 2 2 2 2 2 3 2 1 2 3 2 2 2 2 3 2 3 3 2 3 2 2 3 2 3 1 2 2 2 2 2 3 2
[15805] 2 3 2 3 2 3 2 2 2 3 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 2 3 2 2
[15841] 2 3 3 2 2 2 3 2 2 3 2 2 2 3 2 3 2 3 3 2 2 3 2 3 2 2 2 3 2 2 3 2 3 2 2 2
[15877] 2 3 2 3 3 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 3
[15913] 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 3 3 2
[15949] 2 2 3 3 1 2 2 3 2 2 2 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2
[15985] 3 2 3 2 2 3 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 2 2 2 2 2 2 2 2 2 3 2 2
[16021] 3 3 3 2 3 1 2 3 2 2 3 2 2 2 2 2 3 2 3 3 2 3 2 2 2 3 2 2 2 2 2 3 2 2 2 2
[16057] 3 2 3 3 2 3 2 3 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2 3 2 2 2 2 3 2 3 3
[16093] 3 3 3 2 3 3 3 2 3 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2 3 3 3 3 2 3 3 2 2 3 3 2
[16129] 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 3 2 2 2 3 2 3 2 2 2 2 3 2 3 2 3 3
[16165] 2 3 3 2 2 2 3 2 3 2 1 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2
[16201] 2 2 3 2 3 3 2 2 2 2 1 3 2 3 2 2 2 2 2 2 2 2 3 2 3 2 2 3 2 2 2 2 2 3 2 2
[16237] 2 2 3 3 3 2 2 2 2 2 2 3 3 2 3 2 2 2 2 3 2 3 3 2 2 2 2 2 2 3 2 2 2 3 2 2
[16273] 2 3 2 3 3 2 2 2 3 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 2 2 2
[16309] 3 2 3 2 2 2 2 2 2 2 3 3 2 2 3 2 2 3 2 2 2 3 3 2 2 2 3 3 2 2 2 3 2 2 2 2
[16345] 2 2 3 2 2 2 2 3 3 3 2 2 2 2 2 3 2 2 3 2 3 3 3 3 2 2 3 2 2 3 2 2 2 3 3 2
[16381] 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 2 3 3 2 3 3 2 3 2 3 2
[16417] 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2 3 2 2 2 3 2 2 3 2 2 3 3 2 3 2 2 3 2 3
[16453] 2 2 2 2 2 3 3 2 3 2 3 2 3 3 3 2 2 2 2 3 3 2 2 2 3 2 3 3 3 2 3 3 2 2 3 2
[16489] 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3 2 2 3 2 2 2 2 2 2 2 1 2 2 3 3 2 2 2
[16525] 2 2 2 2 3 2 2 3 2 3 2 2 2 2 2 2 2 3 3 2 2 3 2 3 3 2 2 3 2 2 3 3 2 2 2 2
[16561] 2 3 2 2 3 2 2 2 3 2 2 2 2 3 2 2 3 3 3 3 2 2 2 3 2 3 2 3 3 2 3 2 2 2 3 3
[16597] 2 2 3 2 2 2 2 2 2 3 3 2 2 3 2 3 2 3 2 3 2 2 3 2 2 3 3 2 2 2 2 3 2 3 3 2
[16633] 2 2 2 2 2 2 2 3 3 2 3 2 2 2 2 2 2 2 2 2 2 2 3 3 3 2 2 3 3 2 2 3 3 2 3 2
[16669] 2 2 2 2 2 2 2 2 2 2 2 3 2 3 3 3 2 3 3 2 2 2 3 2 2 3 3 2 3 2 2 2 2 3 2 3
[16705] 2 2 3 3 3 3 2 3 2 2 3 2 2 3 3 3 2 2 2 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2 2 3
[16741] 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 3 3 3 3 3 2 2 2 2 2 2 3 3 2
[16777] 3 2 2 2 2 2 2 2 3 2 3 2 3 2 2 2 3 3 2 2 2 2 3 3 3 2 2 2 3 2 2 2 3 2 2 2
[16813] 2 3 3 2 2 2 3 2 2 3 2 2 3 2 2 3 2 2 2 2 1 2 2 3 2 1 2 3 3 2 3 2 2 2 2 3
[16849] 2 2 2 2 3 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2
[16885] 2 3 2 3 3 2 2 2 2 2 3 2 2 2 3 3 3 2 2 2 2 2 2 2 3 2 2 2 2 3 2 2 3 3 3 2
[16921] 2 2 2 2 2 2 2 3 3 2 2 2 2 3 2 2 3 3 2 2 2 2 2 3 3 2 2 2 3 3 2 2 2 2 2 2
[16957] 2 3 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 3 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2
[16993] 2 3 2 3 2 3 2 2 3 3 2 3 2 3 2 2 2 2 3 2 3 2 2 2 2 3 3 3 2 3 2 2 2 2 3 2
[17029] 2 2 2 2 2 2 3 2 2 3 2 2 3 3 2 2 3 2 3 2 2 2 3 3 3 3 3 3 2 2 2 3 3 3 3 2
[17065] 2 2 2 2 2 3 2 3 2 3 2 2 3 2 3 2 3 2 2 3 3 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2
[17101] 2 2 2 1 2 2 2 2 2 3 2 3 3 2 2 2 2 3 2 2 2 2 2 3 3 3 2 2 3 2 2 2 2 3 2 2
[17137] 2 2 2 2 2 3 2 3 2 2 2 3 3 3 3 2 3 2 2 2 2 2 2 2 2 3 3 2 2 2 2 3 3 3 2 2
[17173] 3 2 3 3 3 3 2 2 3 2 2 2 3 2 2 2 3 3 3 3 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
[17209] 2 2 3 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 3 2 2 2 3 2 3 2 2
[17245] 2 2 2 2 2 2 2 3 2 2 3 2 3 2 3 2 3 2 3 3 2 2 2 2 2 2 2 2 3 2 2 3 2 2 3 3
[17281] 3 2 2 2 3 2 3 2 2 2 3 2 3 3 3 3 2 2 2 2 3 2 2 3 2 2 2 2 2 3 2 2 2 3 2 3
[17317] 3 2 3 3 2 3 2 1 2 2 3 2 2 3 2 3 2 2 2 2 1 2 3 2 3 2 2 3 2 2 2 2 3 2 2 2
[17353] 3 2 2 2 2 2 3 2 3 2 2 2 2 2 3 3 2 2 2 2 3 3 2 2 2 3 3 2 2 2 3 2 2 2 2 2
[17389] 2 2 3 2 2 3 3 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 3 2
[17425] 3 2 2 2 2 3 2 3 2 3 2 2 3 3 2 3 2 2 2 2 3 2 2 3 2 2 2 2 3 3 2 2 3 3 2 2
[17461] 2 2 3 2 3 2 2 3 2 2 2 2 2 2 2 2 3 2 3 2 2 3 2 2 2 2 3 3 2 2 2 2 3 2 2 3
[17497] 2 2 3 2 2 3 3 2 3 3 2 3 3 2 3 3 2 2 3 2 2 3 3 3 3 2 1 3 2 2 2 3 2 3 2 3
[17533] 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2
[17569] 2 2 2 3 2 3 3 2 2 3 3 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 2
[17605] 2 3 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 3 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2
[17641] 2 3 2 2 2 2 3 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 3 2 3 2 2 2 2 3 2 3 3
[17677] 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 3 3 3 2 3 2 2 3 2 3 2 2 2 2 3 2 3 2 2 3 2
[17713] 2 2 2 2 3 3 2 3 2 2 2 2 3 2 2 3 2 3 2 2 2 2 3 2 2 3 2 3 2 2 2 3 2 2 2 3
[17749] 3 2 3 3 3 2 2 2 2 2 3 3 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 3 2 2 2 2
[17785] 2 3 2 2 2 2 3 3 2 2 2 3 2 2 1 2 3 2 3 2 2 2 3 2 2 2 2 2 3 3 2 2 2 2 3 2
[17821] 2 2 2 2 2 3 2 3 3 3 2 2 2 3 2 2 2 3 2 3 2 2 3 2 3 3 2 2 3 2 2 2 3 3 2 2
[17857] 2 2 3 2 3 2 3 2 2 2 2 2 2 3 3 3 3 2 2 2 3 2 2 2 2 3 2 3 2 2 3 3 3 3 2 2
[17893] 2 2 2 3 3 2 3 2 2 2 3 2 2 2 2 2 3 3 3 2 3 3 3 2 2 2 2 2 2 2 2 2 2 2 2 3
[17929] 2 2 2 2 2 2 3 2 2 3 3 2 2 2 2 2 2 3 3 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2
[17965] 3 2 2 3 2 2 3 2 3 3 2 2 2 2 3 3 2 3 2 3 2 3 2 3 3 2 2 2 2 3 2 2 2 2 3 2
[18001] 2 2 3 3 2 3 2 3 2 2 3 2 2 2 3 2 2 2 3 2 2 2 2 2 2 3 3 2 2 2 2 2 3 2 3 3
[18037] 2 3 2 2 2 2 3 2 3 3 2 2 2 3 2 2 2 3 2 3 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2
[18073] 2 2 3 3 2 2 2 2 2 2 2 2 3 2 3 3 3 3 2 2 2 2 2 2 2 3 2 2 2 2 3 2 2 2 3 3
[18109] 2 2 3 2 2 2 2 2 2 2 2 2 3 2 2 3 3 3 3 2 2 3 2 2 2 2 2 2 2 3 3 3 2 3 2 2
[18145] 2 2 3 2 2 2 2 2 2 2 3 3 2 2 2 2 2 3 2 3 2 2 2 3 2 2 3 2 2 3 1 2 2 2 2 2
[18181] 2 2 2 3 2 2 3 2 3 2 2 2 3 3 2 2 2 2 2 2 2 3 2 3 2 2 2 3 2 2 2 2 2 3 3 2
[18217] 2 2 3 2 3 2 3 2 2 3 2 3 2 3 2 2 3 3 3 2 2 2 2 2 2 3 3 2 2 2 2 3 2 2 2 2
[18253] 2 2 2 2 2 3 3 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 3 2 3 2 2 2 3 2 2 3 3 3 2 2
[18289] 2 3 3 3 2 2 3 3 2 2 2 3 2 3 3 2 2 2 3 2 2 2 2 3 2 2 2 3 2 3 3 2 2 3 2 3
[18325] 2 3 2 2 2 3 3 2 2 2 2 2 2 2 3 3 2 2 2 2 2 3 2 3 2 2 2 2 2 3 2 2 2 2 3 2
[18361] 2 2 3 2 3 2 3 2 2 3 3 2 3 2 2 2 2 2 3 2 3 3 2 3 2 2 2 2 2 3 3 2 2 2 3 2
[18397] 2 2 3 2 3 2 3 3 3 2 2 2 2 2 2 2 3 2 2 3 2 2 2 2 3 2 3 3 3 2 2 2 2 3 2 2
[18433] 3 2 2 3 2 3 2 2 3 3 2 2 3 2 2 2 2 2 2 2 2 2 3 2 3 2 3 3 3 2 2 3 2 2 2 2
[18469] 2 2 2 2 2 2 3 2 2 2 2 2 2 3 3 2 2 2 3 2 2 2 2 2 3 3 2 3 2 3 3 3 2 2 2 2
[18505] 3 2 2 3 2 3 2 2 3 2 3 3 2 2 2 3 2 2 2 2 2 2 2 2 3 3 3 3 2 2 2 2 3 2 2 3
[18541] 3 2 2 2 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2 2 2 3 2 2 2
[18577] 2 3 2 1 3 2 2 3 3 3 2 3 3 3 3 2 2 3 3 2 2 3 2 3 2 2 3 3 2 2 2 3 2 2 3 3
[18613] 3 1 3 2 3 3 3 3 2 3 3 2 3 2 3 2 3 2 2 2 2 2 2 2 2 1 2 2 2 2 3 2 2 2 2 3
[18649] 3 2 2 2 3 3 3 2 2 3 2 3 2 2 3 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
[18685] 3 2 2 3 3 3 2 2 3 2 3 3 2 2 3 3 2 3 2 3 2 3 2 2 2 3 2 3 2 2 3 3 2 3 2 2
[18721] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 3 3 2 3 2 2 3 2 3 3 2 3 2 2 3 2 2 2 2
[18757] 2 2 2 2 2 2 2 3 3 2 2 2 3 2 2 3 2 3 2 2 3 3 2 2 2 2 2 2 2 3 3 2 2 3 2 2
[18793] 3 2 3 2 2 3 2 2 2 3 2 3 3 2 2 3 3 3 2 3 2 2 3 2 2 2 2 2 2 2 3 2 3 3 2 2
[18829] 2 2 3 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 3 2 3 2 3 2 2 2 3 2 3 2 2 2 2 2 2 2
[18865] 3 3 2 3 2 2 2 2 3 2 2 2 2 2 3 2 2 3 2 3 3 2 2 3 2 2 2 2 2 3 2 3 3 2 2 3
[18901] 2 2 2 2 3 2 3 2 2 2 3 3 2 2 3 2 3 3 2 2 3 2 3 2 2 2 3 3 2 2 2 3 2 2 2 2
[18937] 2 2 2 2 2 2 3 3 3 3 2 2 3 2 2 3 2 3 2 2 2 3 2 2 3 2 3 2 2 3 3 2 2 2 3 2
[18973] 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 2 2 3 2 2 3 3 3 2 2 3 2 2 2 2 2 3 3 2 2 2
[19009] 3 3 3 2 2 2 2 2 2 3 2 3 2 2 3 2 3 2 2 2 2 2 2 2 3 2 3 3 3 3 2 3 2 2 2 3
[19045] 2 3 3 2 2 3 3 3 2 3 2 3 2 3 2 1 2 2 2 3 2 3 3 2 2 2 2 2 3 2 2 2 3 2 2 2
[19081] 3 2 2 3 2 2 3 3 2 2 2 2 2 2 2 3 3 2 2 2 3 2 2 2 3 2 2 2 3 2 2 3 3 2 3 2
[19117] 3 2 2 2 3 2 2 3 3 3 2 3 2 2 2 2 2 3 2 3 3 2 3 3 2 3 2 2 3 2 3 3 3 2 3 2
[19153] 2 3 2 3 2 3 3 3 3 2 2 2 3 2 2 2 2 3 2 2 3 2 2 2 2 2 2 2 3 2 3 3 2 2 2 3
[19189] 2 2 2 2 3 2 2 2 2 3 3 2 2 3 2 2 2 2 3 3 3 2 2 2 2 2 3 2 3 3 3 2 3 2 2 2
[19225] 3 3 2 3 2 2 2 2 2 3 2 2 2 3 2 2 2 3 3 2 2 2 3 2 2 2 3 2 2 2 2 2 3 3 3 2
[19261] 2 2 2 3 2 2 2 2 2 2 3 2 3 2 2 2 2 2 3 2 3 2 2 2 2 3 2 2 2 2 2 2 2 2 3 3
[19297] 2 3 3 2 2 3 3 3 2 3 2 3 2 2 3 2 2 2 2 2 2 3 2 3 2 2 3 3 2 2 2 2 3 2 2 2
[19333] 2 2 3 2 2 2 1 2 2 2 3 2 3 3 3 2 2 2 2 3 3 2 2 2 3 3 3 2 2 2 2 2 2 2 3 3
[19369] 3 2 2 3 2 3 2 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 3 3 2 2 3 2 2 3 2 3 3 2 3 2
[19405] 3 2 3 3 2 2 3 2 2 2 3 2 2 2 3 3 2 2 2 3 3 2 2 2 2 3 2 3 2 3 2 2 2 3 3 2
[19441] 3 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 3 2 2 2 3 3 2 2 3 2 2 3 2 2 2 2
[19477] 2 2 3 2 2 2 2 2 3 2 3 3 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 3 3 2 2 2 3 3 2
[19513] 2 3 2 2 2 3 2 2 2 2 3 3 2 2 2 3 2 2 3 2 2 2 3 2 2 2 2 2 2 3 3 3 3 2 2 2
[19549] 2 2 2 2 2 2 2 2 2 2 3 2 3 2 3 2 3 2 2 2 2 2 2 2 3 2 2 3 3 2 2 2 2 2 3 2
[19585] 2 2 3 2 2 3 2 2 2 2 3 2 1 2 2 2 2 2 2 3 2 3 2 3 2 2 2 2 3 2 2 2 2 2 2 2
[19621] 3 2 2 2 2 2 3 2 3 3 2 2 2 2 2 2 2 3 2 2 2 2 3 3 3 2 2 3 3 2 2 3 2 2 2 2
[19657] 2 3 2 2 3 3 2 2 2 2 3 2 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2
[19693] 2 2 2 2 2 2 3 3 3 2 2 2 2 2 2 3 2 2 2 2 2 3 3 3 3 2 3 3 2 2 3 2 2 3 2 2
[19729] 2 2 2 3 2 2 3 2 3 2 2 3 2 3 2 2 2 2 2 2 2 2 2 3 3 3 2 3 2 2 2 2 2 3 2 2
[19765] 2 2 2 2 2 3 2 3 2 2 2 3 2 3 2 3 3 2 3 2 2 2 2 2 2 2 3 2 2 2 3 2 2 2 3 3
[19801] 2 3 2 2 3 2 2 3 2 2 2 2 3 2 3 3 2 2 2 3 3 2 3 3 2 3 2 3 2 3 2 2 2 3 2 2
[19837] 2 3 2 3 2 2 3 2 3 2 2 2 2 3 2 2 2 2 2 2 2 3 2 3 3 2 2 2 2 2 2 2 2 2 3 2
[19873] 2 3 3 2 2 2 2 2 2 2 3 3 3 2 2 3 3 2 3 3 2 3 3 3 3 2 2 2 2 2 3 3 2 3 2 3
[19909] 3 2 2 3 3 3 2 2 2 2 2 2 3 2 3 2 2 3 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
[19945] 3 2 3 3 2 2 2 3 2 2 3 2 2 3 2 2 3 2 3 2 2 2 3 3 2 2 2 3 3 2 3 3 3 2 2 2
[19981] 2 2 3 2 3 3 2 2 2 2 2 3 3 2 2 3 3 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3 2 2
[20017] 3 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 3 3 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2 2
[20053] 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2 3 2 3 3 2 3 3 2 3 2 2 2 2 3 2 3 2 3 2 3 3
[20089] 2 2 2 2 3 2 3 2 2 2 2 2 3 2 2 2 2 2 2 3 3 2 1 2 2 2 3 2 3 3 2 3 2 2 2 2
[20125] 2 2 2 2 3 2 3 3 3 2 2 2 2 2 3 2 3 2 3 2 2 2 2 3 2 2 2 2 2 2 3 2 2 3 3 3
[20161] 2 2 3 2 2 3 2 2 2 3 2 3 2 2 2 2 2 3 2 3 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2
[20197] 2 2 2 3 3 2 2 3 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 3 2 3 3 2 2 2 2 2 2 2 2
[20233] 2 2 2 2 2 2 2 3 3 3 2 3 2 2 2 3 2 1 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2
[20269] 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 3 2 2 3 2 3 2
[20305] 2 3 3 2 3 2 2 2 3 2 2 1 3 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 3 2
[20341] 2 3 3 2 3 2 2 2 2 2 2 3 2 3 2 2 3 3 2 2 2 3 2 3 2 2 2 2 2 3 2 2 2 2 2 2
[20377] 2 2 2 2 2 2 3 2 2 2 2 3 2 2 3 3 2 2 2 2 3 3 2 3 2 3 2 3 2 2 2 2 2 3 3 3
[20413] 3 2 2 2 2 2 2 3 2 3 2 2 3 3 2 2 2 2 2 2 2 2 2 2 3 3 2 2 3 2 3 3 2 2 2 2
[20449] 2 2 2 2 3 3 3 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2
[20485] 3 3 2 2 3 2 2 3 2 2 2 2 3 2 3 2 3 2 3 3 2 2 2 2 2 3 2 2 2 3 3 2 3 2 2 2
[20521] 2 2 2 2 3 3 3 2 2 3 2 3 2 2 2 3 3 2 2 2 2 2 2 3 2 3 3 2 2 2 3 3 2 2 2 3
[20557] 3 2 2 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3 3 3 2 2 2 2 2 3 3 2 2 2 2 2 3
[20593] 3 3 2 3 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 3 2 3 2 3 3 2 2 2 2 2 3
[20629] 2 3 2 2 3 2 3 2 2 2 2 2 2 2 2 3 2 3 2 3 2 2 2 3 2 2 2 3 2 3 2 3 2 2 2 2
[20665] 2 2 3 3 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 3 3 3 2 2 3 2 2 2 2 2
[20701] 2 2 2 3 3 2 2 2 3 2 2 2 2 3 2 3 2 2 2 2 3 3 3 2 3 2 2 2 2 2 2 3 3 2 2 3
[20737] 2 2 3 3 2 2 2 2 2 3 2 3 3 3 2 2 2 3 2 2 2 2 3 2 3 2 3 2 2 2 2 2 2 2 3 2
[20773] 2 3 3 3 3 3 3 2 2 2 3 3 2 3 2 2 3 2 2 3 3 2 2 2 3 2 2 3 3 2 3 2 2 2 2 2
[20809] 3 2 3 2 3 2 3 2 2 2 2 2 2 3 3 3 2 2 3 2 2 2 3 3 2 3 3 2 2 2 2 2 2 2 2 2
[20845] 2 2 2 2 2 3 2 3 3 3 2 3 2 3 2 2 2 2 2 2 2 2 3 3 2 2 2 3 1 2 2 2 2 2 2 3
[20881] 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2
[20917] 1 2 2 3 2 3 2 2 3 3 2 3 3 2 3 2 2 2 3 2 2 2 2 2 1 3 2 1 3 2 2 3 2 3 2 2
[20953] 2 2 2 3 2 2 3 3 3 2 3 3 3 2 3 2 2 2 2 2 2 3 2 3 2 2 3 3 3 3 3 2 3 2 2 2
[20989] 2 3 2 2 3 3 2 2 3 3 2 2 3 2 2 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2
[21025] 2 2 2 2 3 2 2 3 2 3 3 3 3 2 3 2 2 3 2 3 2 3 3 2 2 2 3 3 2 3 2 2 2 2 3 3
[21061] 2 2 2 2 2 2 3 3 3 2 2 3 2 2 2 2 2 2 2 2 2 3 2 3 2 3 2 2 3 3 2 3 2 2 2 2
[21097] 2 3 2 2 3 2 2 2 3 3 2 2 3 2 2 2 3 3 2 2 2 2 2 3 3 3 2 2 2 3 2 3 2 3 2 3
[21133] 2 2 2 2 2 2 3 3 3 2 3 3 2 2 3 2 3 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3
[21169] 2 2 3 2 2 3 2 3 2 2 2 2 3 3 2 2 2 2 3 3 2 2 3 3 2 2 2 3 2 3 3 2 2 2 3 3
[21205] 2 3 3 2 2 2 2 3 2 3 2 3 2 2 2 3 2 2 3 2 2 3 2 2 3 3 3 3 2 3 2 2 3 2 3 3
[21241] 2 2 3 3 2 3 2 2 3 3 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2
[21277] 2 2 2 2 3 2 3 2 2 3 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 3 3 3 2 3 2 2 2 3 2 3
[21313] 2 2 2 2 3 3 2 2 3 2 2 2 2 2 2 2 2 2 3 3 2 2 2 2 3 2 2 3 2 3 3 2 3 2 2 2
[21349] 2 3 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 2 2 3 2 3 2 2 2 2 2 3 3 3 2 2 3 2 2 2
[21385] 3 2 2 2 2 2 2 3 3 2 3 3 3 2 2 3 3 3 2 3 3 3 2 2 2 2 3 2 2 2 2 2 2 2 2 2
[21421] 3 2 2 2 2 2 2 2 3 2 2 3 3 2 3 2 2 3 3 2 3 2 3 2 3 3 3 3 2 2 2 2 2 2 2 2
[21457] 2 3 3 2 3 2 2 3 3 3 3 2 2 2 2 2 3 3 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2
[21493] 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2 3 3 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 3 2
[21529] 3 2 3 3 2 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 3 3 2 2 2 2 3 2 2 3
[21565] 3 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 3 2 3 2 2 2 2 2 3 3 2 2 2 2 3 2 2 3
[21601] 2 2 3 2 2 3 2 2 3 2 3 2 2 3 3 2 2 3 3 2 2 2 3 2 2 2 2 3 2 2 2 2 3 3 2 2
[21637] 2 3 2 3 3 2 2 3 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 3 2 3 3 2 2 3 2 2 2 2 3 2
[21673] 3 2 3 3 2 2 2 3 2 3 2 2 1 2 3 2 2 2 2 2 3 1 3 2 3 3 2 3 3 2 2 3 2 2 2 2
[21709] 2 3 2 2 2 3 2 2 3 3 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3 1 3 2 2 2 2
[21745] 2 2 3 2 3 2 2 2 2 2 2 2 2 3 3 2 3 2 3 3 3 2 2 3 2 3 2 3 2 2 2 2 2 2 2 2
[21781] 3 2 3 2 2 2 2 2 3 2 3 2 2 3 2 2 3 2 2 3 2 2 2 3 2 2 2 2 2 3 2 2 3 3 2 3
[21817] 3 2 2 2 2 3 3 2 3 3 3 3 2 2 2 2 3 3 2 3 3 3 2 3 2 2 3 2 2 3 3 2 2 2 2 2
[21853] 3 2 2 3 3 3 2 2 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 3 3 2 2 2 2 3 2 3 2 3 2
[21889] 2 2 3 3 3 2 3 3 3 2 2 3 2 3 2 2 3 2 3 2 3 2 3 3 2 2 2 2 2 2 2 3 3 1 3 2
[21925] 2 2 3 2 2 2 2 2 3 3 3 2 2 2 3 2 2 2 2 3 2 2 2 2 2 1 2 2 2 3 2 3 2 2 2 2
[21961] 2 3 3 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 3 2 2 3 3 2 2 2 2 3 2 2 2 2 2 3
[21997] 2 2 2 2 2 3 2 2 2 3 2 3 3 2 2 2 1 2 2 2 3 3 3 2 3 2 2 2 2 2 2 3 2 2 2 2
[22033] 2 2 3 3 2 2 2 2 3 2 2 3 2 2 3 2 3 2 2 2 2 2 2 2 3 3 3 3 1 2 2 2 2 2 3 3
[22069] 2 2 2 2 3 2 2 2 2 3 3 3 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 3 2 2 3 2 2 2 2 2
[22105] 2 3 2 2 2 2 2 3 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 3 2 2
[22141] 2 2 2 3 2 2 2 2 3 2 2 3 2 2 2 2 2 2 2 3 2 2 3 2 2 2 2 3 2 2 2 3 2 2 2 2
[22177] 2 2 2 2 3 3 2 2 2 2 2 3 3 2 3 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 3
[22213] 3 2 2 3 2 2 2 3 3 3 2 3 3 2 3 3 3 3 2 3 3 3 2 2 2 3 2 2 2 2 2 2 3 2 2 2
[22249] 2 3 2 2 2 2 2 2 3 3 2 2 2 2 3 3 3 2 2 3 3 2 3 2 2 3 3 2 2 3 1 2 2 2 3 2
[22285] 2 2 3 3 2 2 2 2 2 2 2 3 3 2 3 2 2 3 2 2 3 3 2 3 2 2 2 2 3 3 3 2 2 2 3 2
[22321] 2 2 3 2 2 2 2 2 3 2 3 3 2 2 2 3 2 2 2 3 3 2 2 2 2 2 2 1 3 2 2 2 2 3 3 3
[22357] 3 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2 3 2 2 2 2 2 2 3 3 2 3 2 2 3 2 2 2
[22393] 3 3 3 3 3 2 2 2 2 2 2 2 2 2 3 3 2 2 3 3 3 2 2 2 2 2 3 3 3 3 2 2 3 2 3 2
[22429] 2 2 2 3 2 3 3 3 3 2 2 2 2 2 3 3 2 2 2 1 2 2 3 2 2 2 3 2 2 2 2 2 3 2 3 2
[22465] 2 3 3 2 2 3 2 3 3 2 2 2 3 2 3 2 2 3 2 2 2 2 3 2 3 2 2 1 3 3 3 2 2 2 2 2
[22501] 2 2 2 3 2 3 2 3 2 2 2 3 3 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 3 2 2 3 2
[22537] 2 2 2 3 3 2 2 2 2 2 3 2 3 3 2 2 2 2 2 2 2 3 2 2 2 2 3 2 2 2 2 3 2 2 2 2
[22573] 2 2 3 2 2 3 2 2 3 2 2 2 2 1 2 2 2 3 2 3 2 3 2 3 2 2 2 2 2 2 2 2 2 2 3 2
[22609] 2 3 2 2 3 2 2 3 2 2 2 2 3 3 2 3 2 2 2 2 3 2 2 2 2 3 2 2 3 2 2 2 3 2 2 2
[22645] 3 2 2 2 3 3 2 3 3 2 3 3 2 2 3 2 2 2 2 3 3 3 2 2 2 3 2 2 2 2 3 3 2 2 2 3
[22681] 2 2 2 2 1 3 3 2 2 2 3 2 2 3 2 2 2 2 3 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 2 2
[22717] 3 2 2 3 2 3 2 3 3 2 3 2 2 2 2 2 2 2 3 3 3 2 3 2 3 2 2 3 2 2 2 3 3 2 2 3
[22753] 3 3 3 3 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 3 3 2 2 3 3 3 2 3 2 3 2 2 2 2
[22789] 2 2 3 2 2 3 3 3 2 2 2 2 2 3 2 2 3 2 2 2 2 2 2 2 2 2 1 2 2 2 3 2 2 2 2 3
[22825] 3 3 3 2 3 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 3 2 2 2 3 2 2 2 3 3 3 2 2 2
[22861] 3 2 2 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 3 2 3 3 3 2 3 2 2 2 3 2 2 2 3 2 2 2
[22897] 3 3 2 2 2 3 2 2 3 2 2 2 2 3 2 2 2 3 3 2 3 3 2 2 2 2 2 3 3 2 3 2 2 3 2 2
[22933] 2 2 2 2 3 3 3 2 3 2 2 3 2 2 2 3 3 2 3 2 2 2 2 2 2 2 2 3 2 2 3 3 3 2 2 2
[22969] 3 2 2 2 3 2 3 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2 2 2 2 2 2 3 2 3 2 3 2 2 2 2
[23005] 2 2 2 2 2 2 2 2 3 2 2 2 2 2 3 3 2 2 3 3 3 2 2 2 3 3 3 2 2 2 3 2 2 2 2 3
[23041] 3 3 3 2 2 2 3 2 3 2 2 2 3 2 2 2 2 3 2 3 2 2 3 2 2 3 2 2 2 2 3 3 3 3 3 3
[23077] 3 2 2 2 2 2 2 2 3 3 2 3 2 3 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 3 2 3 3
[23113] 2 3 2 2 2 2 2 2 3 2 2 3 3 2 3 3 2 3 3 3 2 2 2 3 2 3 2 2 2 3 3 2 2 3 3 2
[23149] 3 2 3 3 2 2 2 2 2 2 2 2 3 3 3 3 2 2 2 3 2 2 2 2 3 2 2 2 3 2 3 2 2 2 3 2
[23185] 3 3 2 2 2 2 3 3 2 2 2 3 2 3 3 2 2 2 3 3 2 2 3 2 2 2 2 2 2 2 2 3 2 3 2 3
[23221] 2 2 2 2 2 2 3 3 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 3
[23257] 3 3 3 2 2 3 2 3 2 2 3 2 2 2 3 3 2 3 3 2 2 2 2 2 2 2 2 2 3 3 2 3 3 2 3 2
[23293] 2 3 2 3 2 2 2 2 2 3 2 2 3 2 3 3 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2
[23329] 2 2 2 2 3 3 2 2 2 3 2 3 3 2 2 2 2 2 3 2 2 3 2 2 2 2 2 3 3 2 2 2 3 3 2 2
[23365] 2 2 2 3 3 3 2 3 3 2 2 2 2 2 3 3 2 2 2 2 3 2 3 3 2 3 2 2 2 3 2 2 2 2 3 3
[23401] 2 3 2 2 2 2 2 2 2 2 2 2 3 3 2 2 3 2 3 2 3 2 3 2 3 2 2 2 2 2 2 2 2 3 2 3
[23437] 2 2 3 2 2 2 3 3 2 2 2 2 2 2 3 2 2 3 2 3 2 2 2 2 2 2 3 2 3 3 2 2 3 2 2 2
[23473] 2 3 2 3 3 3 2 2 2 2 2 2 3 2 3 3 3 3 2 2 2 2 2 3 2 3 3 3 2 2 3 2 2 2 3 2
[23509] 2 2 2 2 3 2 2 2 3 2 2 2 2 2 3 2 2 2 2 2 3 2 2 3 2 3 2 2 3 2 2 3 2 2 2 3
[23545] 2 2 2 2 2 2 3 2 2 3 3 3 2 3 2 2 3 2 2 3 2 2 2 2 2 2

Within cluster sum of squares by cluster:
[1] 12536.343  2704.777 11852.923
 (between_SS / total_SS =  61.7 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<p>You’ll see a lot of information, but the most important parts are:</p>
<ul>
<li><p>Cluster means (centers): the average recency, frequency, and monetary value for each cluster. These describe the “typical customer” in each group.</p></li>
<li><p>Cluster sizes: the number of customers assigned to each cluster. This shows which groups are large and which are small.</p></li>
</ul>
<p>The other details (like sum of squares) are diagnostics we’ll use later when deciding how many clusters to keep.</p>
<p>So while the raw output looks a bit “ugly,” the take-home message is simple: what each cluster looks like, and how many customers are in each one.</p>
</div>
</div>
</div>
<p>The raw output of the K-means model is not always the easiest to interpret. The numbers are useful, but they don’t give us an immediate feel for how distinct the clusters really are. To help with this, we’ll use the <code>factoextra</code> package. This package provides a set of convenient functions for visualising clustering and dimension-reduction results in R. Here, we’ll use it to create a scatterplot that shows each customer’s cluster membership in a way that’s easy to see at a glance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(kmeans_3, <span class="at">data =</span> rfm_scaled,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">palette =</span> <span class="st">"jco"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive_analytics_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot shows each customer as a point, coloured by the cluster they belong to. Notice that the axes are labelled <em>Dim1</em> and <em>Dim2</em> rather than recency, frequency, and monetary. These are new dimensions created by combining the original variables in a way that makes the clusters as easy to separate as possible. In other words, the plot is giving us the best possible two-dimensional “snapshot” of the clustering results. Each of the <em>Dim</em>s also have a with a percentage in brackets in the axis label. These percentages tell us how much of the overall variation in the data is captured by that dimension.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What are Dim1 and Dim2?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The axes come from a method called <strong>Principal Component Analysis (PCA)</strong>. PCA creates new variables (called <em>principal components</em>) that are linear combinations of the original inputs. - <strong>Dim1</strong> is the combination that explains the most variation in the data. - <strong>Dim2</strong> is the next most important combination, and it is chosen to be independent of Dim1.</p>
<p>Plotting Dim1 and Dim2 together allows us to capture as much of the underlying structure as possible in just two dimensions — even when the original data had more variables. That’s why the axes don’t map neatly onto “recency,” “frequency,” or “monetary,” but instead represent blends of them that best reveal the clusters.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dims are not variables in our data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>It’s tempting to read Dim1 or Dim2 as “recency” or “monetary,” but that’s not correct. Each dimension is a <strong>blend</strong> of all three variables, designed only to make the clusters easier to see. Use them for interpretation of the clustering structure, not for direct business meaning.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Principal Component Analysis (PCA) Beyond Cluster Visualisation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here we used PCA only to reduce three variables (R, F, M) into two dimensions for plotting. But PCA is especially powerful when you have <strong>many variables</strong> — for example, dozens of customer behaviour measures or hundreds of survey items. By summarising those into a handful of principal components, PCA makes complex data more manageable while retaining most of the information. This is why PCA is a common first step in many advanced analytics pipelines, including clustering.</p>
<p>In the tutorial accompanying this chapter you will explore PCA in more depth to help you tackle a different segmentation problem that has more variables.</p>
</div>
</div>
</div>
</section>
<section id="adding-cluster-assignments-to-the-data-profiling-consumers" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="adding-cluster-assignments-to-the-data-profiling-consumers">Adding Cluster Assignments to the Data &amp; Profiling Consumers</h3>
<p>So far, we’ve seen the raw K-means output and a visualization of the clusters. The next step is to bring the cluster assignments back into our dataset so that we can describe and profile each group in business terms.</p>
<p>We’ll use the <code>broom</code> package, which provides tidy outputs for many modelling functions in R. With <code>augment()</code>, broom takes the original data and adds new columns — here, the most important one is <code>.cluster</code>, which tells us which cluster each customer belongs to.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>rfm_clustered <span class="ot">&lt;-</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(kmeans_3, rfm_data) </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rfm_clustered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  users_id frequency monetary recency r_tile f_tile m_tile .cluster
     &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;int&gt;  &lt;int&gt; &lt;fct&gt;   
1        1         1     11.8      18      1      1      1 2       
2        2         2     89        17      1      3      4 2       
3        3         6    156.        1      5      5      5 3       
4        4         4    101.        6      4      4      4 3       
5        5        11    386.        5      4      5      5 3       
6        6         1     21.0      18      1      1      2 2       </code></pre>
</div>
</div>
<p>The new <code>.cluster</code> column shows the cluster assignment for each customer. Now we can summarise the characteristics of each cluster — for example, their average recency, frequency, and monetary value — to see what makes them different.</p>
<p>With the cluster assignments attached to each customer, we can now summarise the groups. A simple way is to calculate the average recency, frequency, and monetary value for each cluster.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>rfm_clustered <span class="sc">|&gt;</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(.cluster) <span class="sc">|&gt;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">recency  =</span> <span class="fu">mean</span>(recency),</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">frequency =</span> <span class="fu">mean</span>(frequency),</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">monetary =</span> <span class="fu">mean</span>(monetary),</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_customers =</span> <span class="fu">n</span>(),</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  .cluster recency frequency monetary n_customers
  &lt;fct&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;
1 1           1.13     36.4    1987.          150
2 2          15.3       1.40     43.5       16287
3 3           3.44      5.80    209.         7133</code></pre>
</div>
</div>
<p>From a managerial perspective, these profiles tell a clear story:</p>
<ul>
<li>Cluster 1 (very recent, very frequent, very high spenders, but a small group of 150 customers) → elite loyalists.</li>
<li>Cluster 2 (long time since last purchase, very infrequent, very low spend) → lapsed low-value customers.</li>
<li>Cluster 3 (fairly recent, moderate frequency and spend) → steady mid-level buyers.</li>
</ul>
<p>This is where clustering becomes actionable: we can see who the most valuable customers are, who may be drifting away, and which groups could be nurtured for growth.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comparing K-means Clusters to RFM Segments
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>It’s useful to connect our K-means results back to the RFM segmentation we built earlier. RFM used fixed quintiles and rules; K-means let the data itself define the groups.</p>
<p>Looking at the cluster profiles, we can see clear parallels:</p>
<ul>
<li><strong>Cluster 1</strong> (very recent, very frequent, very high spenders) ≈ <em>RFM champions / loyal high-value customers</em>.</li>
<li><strong>Cluster 2</strong> (long recency, very low frequency, low spend) ≈ <em>RFM at-risk / lapsed customers</em>.</li>
<li><strong>Cluster 3</strong> (moderate recency, moderate frequency, moderate spend) ≈ <em>RFM (potential) loyalists</em>.</li>
</ul>
<p>One way too see this in the data is to group by the cluster and take the average tile values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>rfm_clustered <span class="sc">|&gt;</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(.cluster) <span class="sc">|&gt;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_recency_tile  =</span> <span class="fu">mean</span>(r_tile),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_frequency_tile =</span> <span class="fu">mean</span>(f_tile),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_monetary_tile =</span> <span class="fu">mean</span>(m_tile),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_customers =</span> <span class="fu">n</span>(),</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  .cluster avg_recency_tile avg_frequency_tile avg_monetary_tile n_customers
  &lt;fct&gt;               &lt;dbl&gt;              &lt;dbl&gt;             &lt;dbl&gt;       &lt;int&gt;
1 1                    4.91               5                 5            150
2 2                    2.26               2.32              2.40       16287
3 3                    4.64               4.51              4.33        7133</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why Link Clusters Back to Raw Data?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>K-means needs <strong>scaled data</strong> (z-scores) to make the clustering fair, since variables measured on different scales (like dollars vs.&nbsp;days) would otherwise distort the results. But once the clusters are created, the <strong>scaled values aren’t very interpretable</strong> for managers.</p>
<ul>
<li>A z-score of 1.5 in monetary spend doesn’t tell a manager much.</li>
<li>Saying “this group spends about $2,000 on average” is clear and actionable.</li>
</ul>
<p>That’s why we always <strong>map the cluster assignments back to the original RFM data</strong>. It lets us profile each group in the actual business units — days since last purchase, number of purchases, and dollars spent — which managers can understand and act on.</p>
</div>
</div>
</div>
<div class="exercise">
<div class="exercise-time">
<p>15 min</p>
</div>
<p>Let’s extend our analysis by running <strong>K-means with 10 clusters</strong> instead of 3. Repeat the same steps we used earlier:</p>
<ol type="1">
<li><p>Run <code>kmeans()</code> with <code>centers = 10</code>.</p></li>
<li><p>Use <code>fviz_cluster()</code> to visualise the 10 clusters.</p></li>
</ol>
<ul>
<li>What do you notice about the spread and separation of the clusters?</li>
<li>Are there clear groups, or do some clusters overlap heavily?</li>
</ul>
<ol start="3" type="1">
<li><p>Attach the cluster assignments back to the <strong>raw RFM data</strong> (not the scaled data).</p></li>
<li><p>Summarise each cluster to get its average recency, frequency, and monetary values.</p></li>
<li><p>Based on these profiles, try to match each cluster to one of the familiar <strong>RFM-style segments</strong> (e.g., Champions, At Risk, Steady Buyers).</p></li>
</ol>
<p>Questions to answer: - Which cluster(s) look like <strong>Champions</strong> (recent, frequent, high spenders)? - Which cluster(s) look like <strong>At Risk / Lapsed</strong> customers? - Which cluster(s) might be <strong>Potential Loyalists</strong> or <strong>Steady Buyers</strong>? - Does having 10 clusters give you <strong>new insights</strong> compared to the 3-cluster solution, or does it make the story harder to communicate?</p>
</div>
<div class="solution-header">
<p>Solution</p>
</div>
<div class="solution-content">
<p><strong>1. Run K-means with 10 clusters</strong> - Use <code>k10 &lt;- kmeans(rfm_scaled, centers = 10)</code>. - Remember to set a seed for reproducibility.</p>
<p><strong>2. Visualise with <code>fviz_cluster()</code></strong> - You’ll see 10 colours, but many clusters will overlap. - This shows that splitting into 10 groups often produces clusters that are <strong>indistinguishable in practice</strong>.</p>
<p><strong>3. Attach clusters back to raw RFM data</strong> - Use <code>rfm_data |&gt; mutate(cluster = k10$cluster)</code>. - This gives you cluster assignments in real business units.</p>
<p><strong>4. Summarise clusters</strong> - Calculate average recency, frequency, and monetary for each cluster. - You’ll likely notice that several clusters have almost identical averages.</p>
<p><strong>5. Interpret clusters</strong> - A few clusters will match clearly to RFM-style groups (e.g., Champions, At Risk). - But many clusters won’t add much extra insight compared to the 3-cluster solution.</p>
<p><strong>Key takeaway</strong> - Asking for too many clusters can make the segmentation look detailed, but in reality many groups are <strong>redundant</strong>. - For managers, simpler solutions (like 3–4 clusters) are usually more actionable. - This highlights the importance of balancing <strong>granularity</strong> with <strong>interpretability</strong> when choosing (k).</p>
</div>
</section>
<section id="how-many-clusters-should-we-use" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="how-many-clusters-should-we-use">How Many Clusters Should We Use?</h3>
<p>So far, we have been running K-means with three clusters. That was useful for learning the workflow, but notice that we didn’t really have a clear rationale for picking the number three.</p>
<p>With RFM, we <strong>fixed quintiles</strong> and then a human decided how many segments to create (e.g., 10 segments from the tile scores). K-means is different: it can take the human out of the loop by suggesting how many clusters best fit the data. The challenge is that we need a systematic way to decide on (k). If we pick too few clusters, we risk missing important differences between customers. On the other hand, if we pick too many, we may end up with groups that are indistinguishable and hard to explain to managers, like in the exercise above.</p>
<p>To figure out how many clusters make sense, we can’t just look at the data once — we actually need to <strong>run K-means many times with different values of (k)</strong>. For example, we might run it with (k = 2), then with (k = 3), then with (k = 4), and so on. Each time, the algorithm produces clusters, and we can measure how well those clusters “fit” the data. Fitting the data here means spotting where adding more clusters really improves the segmentation — and where it stops adding value. This gives us a more objective basis for choosing the right number of clusters, rather than just picking a number (like 3) without justification.</p>
<p>To explore different choices of (k), we need to run K-means many times. On a large dataset this can be slow, so a common trick is to work with a <strong>random sample</strong> of customers. This smaller sample still gives us a good sense of the cluster structure while keeping computations fast.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># so we sample the same people!</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>rfm_scale_sample <span class="ot">&lt;-</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a> rfm_scaled <span class="sc">|&gt;</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">sample_n</span>(<span class="dv">1000</span>)  <span class="co"># take 1,000 random customers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There isn’t just one way to decide on the “right” number of clusters. In practice, analysts use several different methods to guide the choice of (k). Each method has its own logic, and together they give us a more rounded view.</p>
<p>In this section we’ll look at three common methods:</p>
<ol type="1">
<li>The <strong>Elbow Method</strong></li>
<li>The <strong>Silhouette Method</strong></li>
<li>The <strong>Gap Statistic</strong></li>
</ol>
<section id="the-elbow-method" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-elbow-method">The Elbow Method</h4>
<p>The Elbow Method is one of the simplest and most widely used techniques. It is based on a measure called the <strong>within-cluster sum of squares (WSS)</strong>. WSS tells us how tightly the customers are grouped within each cluster: lower WSS means customers inside a cluster are very similar to each other.</p>
<p>Here’s the key idea:</p>
<ul>
<li>As we increase (k), WSS will always go down — more clusters means each cluster can get smaller and tighter.</li>
<li>But the <em>improvement</em> in WSS gets smaller and smaller as we keep adding clusters.</li>
<li>If we plot WSS against (k), the curve usually bends like an arm, and the point where it bends looks like an <strong>elbow</strong>.</li>
</ul>
<p>That elbow point suggests a good trade-off: enough clusters to capture the main differences, but not so many that we end up with redundant groups.</p>
<p>We can implement the Elbow method as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a> rfm_scale_sample, </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a> kmeans,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a> <span class="at">method =</span> <span class="st">"wss"</span>,   <span class="co"># Within-cluster sum of squares</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a> <span class="at">k.max =</span> <span class="dv">15</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a> <span class="at">nstart =</span> <span class="dv">5</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive_analytics_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the figure above we can see the curve drop steeply at first and then start to flatten. In our case, the biggest improvements in WSS come between 2 and 4 clusters. After (k = 4), the line levels off — adding more clusters still lowers WSS, but only by small amounts.</p>
<p>This bend around 4 is the “elbow.” It suggests that 4 clusters strike a good balance: enough to capture meaningful differences between customers, but not so many that we end up with redundant or overlapping groups.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Extra Arguments in the Elbow Method
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p><code>k.max = 15</code>: tells R to test values of <span class="math inline">\(k\)</span> from 1 up to 15. You can increase or decrease this depending on how many clusters you want to check.</p></li>
<li><p><code>nstart = 5</code>: K-means begins with random placements of the cluster centers. By running it 5 times with different random starts, we reduce the risk of getting stuck in a poor solution. For serious work, analysts often use larger values (20, 50, or more) to ensure stability.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
There’s No Perfect Elbow
</div>
</div>
<div class="callout-body-container callout-body">
<p>Just like our own elbows aren’t perfectly shaped, the elbow plot may not show a sharp bend. Don’t expect a perfect elbow — sometimes the curve is gradual, and there isn’t one obvious elbow point. In those cases, there may not be a single “correct” answer, and you’ll need to balance the statistics with business interpretability.</p>
</div>
</div>
</section>
<section id="the-silhouette-method" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-silhouette-method">The Silhouette Method</h4>
<p>Another popular approach is the <strong>Silhouette Method</strong>. Where the elbow method looked at how tightly customers are grouped inside each cluster, the silhouette method asks a different question: <em>“How well does each customer fit into its assigned cluster compared to the next closest cluster?”</em></p>
<p>The silhouette score for a single customer ranges from <strong>–1 to 1</strong>:</p>
<ul>
<li>A value close to <strong>1</strong> means the customer is much closer to their own cluster than to others (a good fit).</li>
<li>A value near <strong>0</strong> means they sit on the border between two clusters.</li>
<li>A negative value means they might actually belong in another cluster.</li>
</ul>
<p>By averaging these scores across all customers, we get a measure of how well-defined the clusters are overall. The <strong>best number of clusters</strong> is the one that gives the <strong>highest average silhouette score</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a> rfm_scale_sample, </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a> kmeans,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a> <span class="at">method =</span> <span class="st">"silhouette"</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive_analytics_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In our dataset, the silhouette plot suggests that the clustering quality peaks at around 3 clusters. That means customers are, on average, most clearly separated into groups when k=3.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Every Customer Needs Their Space
</div>
</div>
<div class="callout-body-container callout-body">
<p>Silhouette scores tell us how “comfortable” each customer feels in their cluster.</p>
<ul>
<li>High scores: the customer is happily surrounded by similar neighbours.</li>
<li>Low scores: they’re awkwardly stuck between groups.</li>
<li>Negative scores: they probably wandered into the wrong party.</li>
</ul>
<p>That’s why the average silhouette is a handy guide — it shows us how much breathing room the clusters really give customers.</p>
</div>
</div>
</section>
<section id="the-gap-statistic" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-gap-statistic">The Gap Statistic</h4>
<p>A third method is the <strong>Gap Statistic</strong>. This approach asks: <em>“Do the clusters in our data look more meaningful than clusters we’d expect if the data were completely random?”</em></p>
<p>Here’s how it works:</p>
<ul>
<li>The algorithm compares the clustering results from our dataset to clustering results from many random datasets with no real structure.</li>
<li>The <strong>gap</strong> is the difference between the two: how much better our clusters are than random ones.</li>
<li>If adding more clusters doesn’t improve the gap clearly beyond the random “wiggle,” the method stops.</li>
<li>That means the recommended number of clusters is often smaller than the place where the gap looks biggest in the plot — it prefers the simpler solution unless the bigger one is <strong>clearly better</strong>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a> rfm_scale_sample, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a> kmeans,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a> <span class="at">method =</span> <span class="st">"gap_stat"</span>,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a> <span class="at">nstart =</span> <span class="dv">10</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a> <span class="at">iter.max =</span> <span class="dv">50</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive_analytics_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In our plot, the gap statistic curve flattens for several values of (k), then makes a noticeable jump. But the function still recommends a lower (k). This is because the method is deliberately <strong>conservative</strong>: it only picks a bigger (k) if the improvement is clearly better than what could be explained by random variation. If not, it sticks with the simpler solution.</p>
<p>That’s why the printed result may suggest fewer clusters than your eyes would pick from the plot. It’s not wrong — it’s just using a conservative rule that prefers a simpler solution if two choices are statistically similar. For business decisions, this is another reminder that <strong>judgment matters</strong>: we balance the statistical guidance with what makes sense for managers.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Arguments in <code>fviz_nbclust()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p><code>nstart = 10</code>: K-means starts with random cluster centers. Running it 10 times and keeping the best solution improves stability. (For bigger jobs, analysts often increase this further.)</p></li>
<li><p><code>iter.max = 50</code>: the maximum number of times K-means can iterate to reassign customers and update centroids before it stops. Higher values give the algorithm more chances to converge, but also take longer to run.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What the Bars in the Gap Plot Really Mean
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The vertical bars in the gap statistic plot are <strong>not error bars on the clusters</strong>. They show the <strong>amount of natural wiggle</strong> that comes from comparing our data to lots of random datasets.</p>
<p>If adding another cluster only improves the gap by a little — within that wiggle — the method says “not worth it” and sticks with fewer clusters. That’s why the recommended (k) can be smaller than the “big jump” you might notice by eye. It’s a built-in preference for <strong>simplicity unless extra complexity is clearly justified</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mind the Gap
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The gap statistic is asking: <em>“Are these clusters really better than random chance?”</em></p>
<p>If the gap is <strong>big</strong>, it means our clusters capture real structure in the data. If the gap is <strong>small</strong>, the extra clusters might just be noise.</p>
<p>That’s why the method is conservative: it won’t add clusters unless the improvement is clearly beyond the random wiggle. In practice, this often means the recommended (k) is smaller than what your eyes might pick from the plot.</p>
</div>
</div>
</div>
<div class="exercise">
<div class="exercise-time">
<p>8 min</p>
</div>
<p>Our diagnostics gave us mixed signals:</p>
<ul>
<li><strong>Elbow Method</strong> → around 4 clusters</li>
<li><strong>Silhouette Method</strong> → 3 clusters</li>
<li><strong>Gap Statistic</strong> → around 4 clusters</li>
</ul>
<p>Since both the elbow and gap methods point to <strong>4 clusters</strong>, let’s explore that solution.</p>
<ol type="1">
<li>Re-run K-means with <code>centers = 4</code>.</li>
<li>Attach the cluster assignments back to the <strong>raw RFM data</strong> (not the scaled version).</li>
<li>Summarise each cluster by average recency, frequency, monetary, and number of customers.</li>
<li>Look for <strong>meaningful differences</strong> across the 4 groups.</li>
</ol>
<ul>
<li>Which clusters look like <em>Champions</em>?</li>
<li>Which resemble <em>At Risk</em> or <em>Lapsed</em> customers?</li>
<li>Do any groups split into subgroups of interest (e.g., frequent but lower spend vs.&nbsp;moderate buyers)?</li>
</ul>
</div>
<div class="solution-header">
<p>Solution</p>
</div>
<div class="solution-content">
<p><strong>1. Estimate 4 clusters</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(rfm_scaled, <span class="at">centers =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Attach clusters with <code>augment()</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>rfm_clustered4 <span class="ot">&lt;-</span> <span class="fu">augment</span>(k4, rfm_data)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rfm_clustered4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  users_id frequency monetary recency r_tile f_tile m_tile .cluster
     &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;int&gt;  &lt;int&gt; &lt;fct&gt;   
1        1         1     11.8      18      1      1      1 2       
2        2         2     89        17      1      3      4 2       
3        3         6    156.        1      5      5      5 4       
4        4         4    101.        6      4      4      4 4       
5        5        11    386.        5      4      5      5 4       
6        6         1     21.0      18      1      1      2 2       </code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Summarise clusters</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>rfm_clustered4 <span class="sc">|&gt;</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(.cluster) <span class="sc">|&gt;</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">recency  =</span> <span class="fu">mean</span>(recency),</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">frequency =</span> <span class="fu">mean</span>(frequency),</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">monetary =</span> <span class="fu">mean</span>(monetary),</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_customers =</span> <span class="fu">n</span>(),</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  .cluster recency frequency monetary n_customers
  &lt;fct&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;
1 1           1.05     83.3    4663.           22
2 2          15.4       1.38     43.0       16020
3 3           1.63     16.8     783.          831
4 4           3.83      4.74    158.         6697</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Interpret</li>
</ol>
<ul>
<li>Cluster 1: Champions — extremely recent, very frequent, very high spenders. A tiny but enormously valuable group.</li>
<li>Cluster 2: Lapsed low-value customers — long recency, almost no repeat purchases, very low spend. The largest group but least valuable.</li>
<li>Cluster 3: Elite loyalists — recent, frequent, and high spenders. Larger than Cluster 1 but still a minority.</li>
<li>Cluster 4: Steady mid-level buyers — moderate recency, frequency, and spend. A substantial group with growth potential.</li>
</ul>
<p><strong>Key takeaway</strong></p>
<p>The 4-cluster solution balances simplicity and detail:</p>
<ul>
<li>It distinguishes between two types of high-value customers (Cluster 1 “Champion” vs.&nbsp;Cluster 3 “loyalist”).</li>
<li>It separates the huge low-value base (Cluster 2) from steady but moderate buyers (Cluster 4).</li>
</ul>
<p>This gives managers a clear, actionable segmentation to work with.</p>
</div>
</section>
</section>
</section>
<section id="wrap-up" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="wrap-up"><span class="header-section-number">10.5</span> Wrap Up</h2>
<p>In this chapter, we explored two different approaches to customer segmentation:</p>
<ul>
<li><p><strong>Rule-based segmentation with RFM</strong></p></li>
<li><p>Simple, transparent, and manager-friendly.</p></li>
<li><p>Groups customers using fixed cut-offs (quintiles) and human choices about how many segments to create.</p></li>
<li><p>Easy to explain, but rigid — it may miss patterns that don’t line up neatly with the rules.</p></li>
<li><p><strong>K-means clustering</strong></p></li>
<li><p>A data-driven alternative that lets the algorithm decide where the boundaries between groups should be.</p></li>
<li><p>Requires us to choose the number of clusters ((k)), which we guided using diagnostics like the elbow method, silhouette scores, and the gap statistic.</p></li>
<li><p>Produces clusters that adapt to the data and can scale to many more variables, but the results are less intuitive without careful profiling and interpretation.</p></li>
</ul>
<p>Together, these methods are complementary rather than competing:</p>
<ul>
<li>RFM provides a quick, rule-based snapshot that’s easy to communicate.</li>
<li>K-means digs deeper, uncovering patterns that might not be obvious from rules alone.</li>
</ul>
<p>For managers, the choice depends on the business context:</p>
<ul>
<li>If clarity and simplicity are the priority, RFM may be the best tool.</li>
<li>If flexibility and precision are needed — especially with larger datasets — K-means offers richer insights.</li>
</ul>
<p>The most powerful insight comes from <strong>combining both</strong>: start with RFM to build intuition (and potentially a business theory) and provide a benchmark, then use clustering to refine the picture and test whether the rule-based groups align with natural patterns in the data.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../advanced_analytics/data_variation.html" class="pagination-link" aria-label="Variation in Cross-Sectional, Times-Series, and Panel Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Variation in Cross-Sectional, Times-Series, and Panel Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../advanced_analytics/causal_analytics.html" class="pagination-link" aria-label="Causal Analytics">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Causal Analytics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>